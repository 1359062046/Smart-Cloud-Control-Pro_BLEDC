<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>水墨屏遥控器原型</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #f0f0f0;
            font-family: Arial, sans-serif;
        }

        .remote-control {
            width: 220px;
            height: 770px;
            background-color: #1a1a1a;
            border-radius: 30px;
            padding: 30px 20px 20px 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }

        .screen {
            width: 160px;
            height: 160px;
            background-color: #f0f0f0;
            border: 1px solid #ccc;
            border-radius: 10px;
            margin-bottom: 30px;
            margin-left: auto;
            margin-right: auto;
            padding: 0;
            font-size: 12px;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: flex-start;
            text-align: left;
            position: relative;
            overflow: hidden;
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.1);
            font-family: 'Courier New', monospace;
            align-self: center;
        }

        .screen-header {
            width: 100%;
            height: 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0;
            padding: 0 2px;
            border-bottom: 1px solid #ccc;
        }

        .device-id {
            font-size: 9px;
        }

        .battery {
            width: 32px;
            height: 16px;
        }

        .battery svg {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .screen-content {
            height: 144px;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: flex-start;
            width: 100%;
            padding: 0;
        }

        .device-count {
            margin-bottom: 4px;
            font-size: 12px;
            width: 100%;
            text-align: center;
        }

        .status-message {
            font-size: 16px;
            margin-bottom: 4px;
            width: 100%;
        }

        .instruction {
            font-size: 16px;
            color: #666;
            width: 100%;
        }

        .buttons {
            display: grid;
            grid-template-columns: 64px 64px;
            grid-template-rows: 64px 64px 64px 64px;
            gap: 15px;
            width: 160px;
            margin-left: auto;
            margin-right: auto;
            justify-content: space-between;
        }

        .button {
            width: 64px;
            height: 64px;
            background-color: #000;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #fff;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.2s ease;
            user-select: none;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.3), 0 -1px 2px rgba(255, 255, 255, 0.1) inset;
            position: relative;
        }

        .button:hover {
            background-color: #444;
        }

        .button:active {
            background-color: #555;
            transform: scale(0.95);
        }

        .button-icon {
            font-size: 18px;
        }

        /* 屏幕状态样式 */
        .screen-state {
            display: none;
            width: 100%;
            height: 100%;
            flex-direction: column;
        }

        .screen-state.active {
            display: flex;
        }

        /* 设置页面样式 */
        .settings-menu {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: flex-start;
            width: 100%;
        }

        .settings-item {
            margin: 2px 0;
            padding: 2px 4px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
            width: 100%;
        }

        .settings-item.selected {
            background-color: #e0e0e0;
        }

        /* 设备列表页面样式 */
        .device-list {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: flex-start;
            width: 100%;
        }

        /* 测试列表页面样式 */
        .test-list {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: flex-start;
            width: 100%;
        }

        .test-item {
            margin: 0;
            padding: 2px 4px;
            font-size: 12px;
            width: 100%;
            height: 24px;
            line-height: 24px;
            box-sizing: border-box;
            border-bottom: 1px dashed #eee;
        }

        /* 确保所有文字不加粗 */
        * {
            font-weight: normal !important;
        }

        /* 待机状态样式 */
        .standby-content {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: flex-start;
        }

        /* 设备图标区域 */
        .device-icon-area {
            width: 100%;
            height: 72px; /* 3行高度：24px * 3 */
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 0;
            padding: 0;
        }

        /* 设备图标 */
        .device-icon {
            width: 32px;
            height: 32px;
        }

        /* 居中显示样式 */
        .center-text {
            text-align: center;
            width: 100%;
        }

        /* 空行样式 */
        .empty-line {
            height: 24px;
            width: 100%;
        }

        /* 设备名称样式 */
        .device-name {
            font-size: 16px;
            margin: 0;
            padding: 0;
        }

        /* 合并行区域 */
        .merged-line-area {
            width: 100%;
            height: 96px; /* 4行高度：24px * 4 */
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* 已添加设备合并行 */
        .merged-device-name {
            width: 100%;
            height: 48px; /* 2行高度：24px * 2 */
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 16px;
        }

        /* 设置页面样式 */
        .settings-content {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: flex-start;
        }
        
        /* 广播动画样式 */
        .broadcast-container {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .broadcast-container .icon {
            display: block;
        }

        /* 设置页面头部 */
        .settings-header {
            width: 100%;
            height: 24px;
            display: flex;
            justify-content: flex-start;
            align-items: center;
            margin-bottom: 0;
            padding: 0 2px;
        }

        /* 设置图标 */
        .settings-icon {
            font-size: 12px;
            margin-right: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* 设置标题 */
        .settings-title {
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* 设置项列表 */
        .settings-list {
            width: 100%;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: flex-start;
            overflow-y: auto;
            overflow-x: hidden;
        }

        /* 设置项 */
        .settings-item {
            width: 100%;
            height: 24px;
            line-height: 24px;
            font-size: 16px;
            padding: 0;
            margin: 0;
            cursor: pointer;
            box-sizing: border-box;
            text-indent: 4px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* 设置项箭头 */
        .settings-item-arrow {
            font-size: 10px;
            margin-right: 4px;
        }

        /* 选中的设置项 */
        .settings-item.selected {
            background-color: #333;
            color: #fff;
        }

        /* 二维码区域 */
        .qrcode-area {
            width: 100%;
            height: 96px; /* 4行高度：24px * 4 */
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* 二维码占位符 */
        .qrcode-placeholder {
            width: 80px;
            height: 80px;
            background-color: #e0e0e0;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 12px;
            border: 1px solid #ccc;
        }
    </style>
</head>
<body>
    <div class="remote-control">
        <!-- 水墨屏幕 -->
        <div class="screen">
            <!-- 顶部固定区域 -->
            <div class="screen-header">
                <div class="device-id">NO.1688</div>
                <div class="battery">
                    <svg t="1764593628569" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5749"><path d="M938.667 426.667v-85.334c0-46.933-38.4-85.333-85.334-85.333H128c-46.933 0-85.333 38.4-85.333 85.333v341.334C42.667 729.6 81.067 768 128 768h725.333c46.934 0 85.334-38.4 85.334-85.333v-85.334c23.466 0 42.666-19.2 42.666-42.666v-85.334c0-23.466-19.2-42.666-42.666-42.666zM896 469.333v213.334c0 23.466-19.2 42.666-42.667 42.666H128c-23.467 0-42.667-19.2-42.667-42.666V341.333c0-23.466 19.2-42.666 42.667-42.666h725.333c23.467 0 42.667 19.2 42.667 42.666v128zM128 682.667h554.667V341.333H128v341.334z" fill="#2C2C2C" p-id="5750"></path></svg>
                </div>
            </div>
            
            <!-- 下方动态区域 -->
            <div class="screen-content">
                <!-- 待机状态将通过JS动态插入到这里 -->
            </div>
        </div>

        <!-- 按钮区域 -->
        <div class="buttons">
            <!-- 第一行 -->
            <div class="button" id="btn-open">
                开
            </div>
            <div class="button" id="btn-up">
                <svg width="20" height="20" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="7396"><path d="M81.522712 687.094854c14.471596 14.285355 37.747719 14.2127 52.071959-0.224104l377.321648-380.777353 382.585535 379.158483c14.471596 14.32424 37.748742 14.217816 52.112891-0.218988 14.33038-14.477736 14.217816-37.787628-0.218988-52.118008L538.761504 229.962485c-0.62831-0.623193-1.438769-0.769526-2.061962-1.359974-0.152473-0.145309-0.185218-0.330528-0.332575-0.477884-7.181563-7.108908-16.57756-10.683317-25.928532-10.683317-9.463536 0-18.96698 3.647063-26.148543 10.902304L81.33647 634.977869C66.973344 649.453558 67.084884 672.765497 81.522712 687.094854L81.522712 687.094854zM81.522712 687.094854" fill="#ffffff" p-id="7397"></path></svg>
            </div>
            
            <!-- 第二行 -->
            <div class="button" id="btn-stop">
                停
            </div>
            <div class="button" id="btn-down">
                <svg width="20" height="20" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="7396" style="transform: rotate(180deg);"><path d="M81.522712 687.094854c14.471596 14.285355 37.747719 14.2127 52.071959-0.224104l377.321648-380.777353 382.585535 379.158483c14.471596 14.32424 37.748742 14.217816 52.112891-0.218988 14.33038-14.477736 14.217816-37.787628-0.218988-52.118008L538.761504 229.962485c-0.62831-0.623193-1.438769-0.769526-2.061962-1.359974-0.152473-0.145309-0.185218-0.330528-0.332575-0.477884-7.181563-7.108908-16.57756-10.683317-25.928532-10.683317-9.463536 0-18.96698 3.647063-26.148543 10.902304L81.33647 634.977869C66.973344 649.453558 67.084884 672.765497 81.522712 687.094854L81.522712 687.094854zM81.522712 687.094854" fill="#ffffff" p-id="7397"></path></svg>
            </div>
            
            <!-- 第三行 -->
            <div class="button" id="btn-close">
                关
            </div>
            <div class="button" id="btn-ok">
                OK
            </div>
            
            <!-- 第四行 -->
            <div class="button" id="btn-a">
                A
            </div>
            <div class="button" id="btn-home">
                <svg width="20" height="20" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"><path d="M923.733333 394.666667c-85.333333-70.4-206.933333-174.933333-362.666666-309.333334C533.333333 61.866667 490.666667 61.866667 462.933333 85.333333c-155.733333 134.4-277.333333 238.933333-362.666666 309.333334-14.933333 14.933333-25.6 34.133333-25.6 53.333333 0 38.4 32 70.4 70.4 70.4H192v358.4c0 29.866667 23.466667 53.333333 53.333333 53.333333H405.333333c29.866667 0 53.333333-23.466667 53.333334-53.333333v-206.933333h106.666666v206.933333c0 29.866667 23.466667 53.333333 53.333334 53.333333h160c29.866667 0 53.333333-23.466667 53.333333-53.333333V518.4h46.933333c38.4 0 70.4-32 70.4-70.4 0-21.333333-10.666667-40.533333-25.6-53.333333z m-44.8 59.733333h-57.6c-29.866667 0-53.333333 23.466667-53.333333 53.333333v358.4h-138.666667V661.333333c0-29.866667-23.466667-53.333333-53.333333-53.333333h-128c-29.866667 0-53.333333 23.466667-53.333333 53.333333v206.933334H256V507.733333c0-29.866667-23.466667-53.333333-53.333333-53.333333H145.066667c-4.266667 0-6.4-2.133333-6.4-6.4 0-2.133333 2.133333-4.266667 2.133333-6.4 85.333333-70.4 206.933333-174.933333 362.666667-309.333333 4.266667-4.266667 10.666667-4.266667 14.933333 0 155.733333 134.4 277.333333 238.933333 362.666667 309.333333 2.133333 2.133333 2.133333 2.133333 2.133333 4.266667 2.133333 6.4-2.133333 8.533333-4.266667 8.533333z" fill="#ffffff" p-id="5562"></path></svg>
            </div>
        </div>
    </div>

    <script>
        // 获取DOM元素
        const screenContent = document.querySelector('.screen-content');
        
        const buttons = {
            open: document.getElementById('btn-open'),
            up: document.getElementById('btn-up'),
            stop: document.getElementById('btn-stop'),
            down: document.getElementById('btn-down'),
            close: document.getElementById('btn-close'),
            ok: document.getElementById('btn-ok'),
            a: document.getElementById('btn-a'),
            home: document.getElementById('btn-home')
        };

        // 应用状态管理
            const appState = {
                currentPage: 'standby', // 当前页面：standby, settings, submenu, bluetoothPairing, pairingResult, continuePairing, pairingTimeout, exitPairingConfirm, doorWindowInfo, deleteConfirm
                settingsIndex: 0, // 当前选中的设置项索引
                settingsPage: 0, // 当前设置页
                settingsPerPage: 5, // 每页显示的设置项数量
                
                // 子菜单状态
                currentSubMenu: null, // 当前子菜单名称
                subMenuIndex: 0, // 当前选中的子菜单项索引
                subMenuPage: 0, // 当前子菜单页码
                subMenuPerPage: 5, // 每页显示的子菜单项数量
                
                // 配对页面状态
                continuePairingIndex: 1, // 是否继续配对选项索引，0:添加同控门窗，1:取消
                exitPairingIndex: 0, // 退出配对确认选项索引，0:取消，1:确认
                // 删除确认选项索引，0:取消，1:删除
                deleteConfirmIndex: 0, // 删除确认选项索引，0:取消，1:删除
                
                // 门窗类型选择
                currentDoorWindowType: null, // 当前选择的门窗类型
                isAddingSameControlDevice: false, // 是否正在添加同控门窗
                isRePairing: false, // 是否正在重新配对
                isFromDeviceInfo: false, // 是否从设备信息页面进入的同控设备添加
                
                // 设备列表
                devices: [], // 设备列表
                currentDeviceIndex: 0, // 当前设备索引
                rePairingDeviceIndex: -1, // 正在重新配对的设备索引
                
                // 门窗信息页面状态
                doorWindowInfoIndex: 0, // 当前选中的门窗信息选项索引
                
                // 童锁状态管理
                isChildLockEnabled: false, // 童锁是否开启，默认关闭
                
                // 自动关门感应状态管理
                isAutoCloseEnabled: false, // 自动关门感应是否开启，默认关闭
                
                // 显示模式状态管理
                displayModeIndex: 0, // 当前选中的显示模式索引，0:流畅，1:清晰
                
                // 语言设置状态管理
                languageIndex: 0, // 当前选中的语言索引，0:中文，1:English
                languageOptions: ['中文', 'English', '返回'],
                
                // 恢复出厂设置状态管理
                resetFactoryIndex: 0, // 当前选中的恢复出厂设置选项索引，0:取消，1:确定
                
                // 发送指令页面状态管理
                currentCommand: '', // 当前发送的指令
                commandTimer: null, // 指令页面自动返回的定时器
                
                // 门窗信息选项列表
                doorWindowInfoItems: [
                    '重新配对',
                    '添加同控门窗',
                    '删除配对',
                    '返回'
                ],
                
                // 设置项列表
                settingsItems: [
                    '门窗配对',
                    '门窗列表',
                    '门窗重命名',
                    '自动关门感应',
                    '童锁',
                    '用户手册',
                    '更多'
                ],
                
                // 子菜单项列表
                subMenuItems: {
                    '门窗配对': [
                        '客厅窗户',
                        '主卧窗户',
                        '次卧窗户',
                        '客卧窗户',
                        '客厅门',
                        '阳台门',
                        '卧室门',
                        '返回'
                    ],
                    '自动关门感应': [
                        '开启',
                        '关闭',
                        '使用说明',
                        '返回'
                    ],
                    '童锁': [
                        '关闭',
                        '开启',
                        '返回'
                    ],
                    '更多': [
                        '显示模式',
                        '语言',
                        '恢复出厂设置',
                        '返回'
                    ]
                },
                
                // 更新待机状态显示
                updateStandbyDisplay: function() {
                    const hasDevice = this.devices.length > 0;
                    let content = '';
                    
                    if (!hasDevice) {
                        // 未添加设备状态：合并第2-5行，文案居中显示
                        content = `
                            <div class="standby-content standby-no-device">
                                <div class="device-count">设备${0}/${this.devices.length}</div>
                                <div class="merged-line-area">
                                    <div class="status-message center-text" style="font-size: 16px;">暂未绑定门窗</div>
                                </div>
                                <div class="instruction center-text" style="font-size: 16px;">按OK键进入设置</div>
                            </div>
                        `;
                    } else {
                        // 已添加设备状态：合并第5-6行，文案居中显示，字体16px
                        const currentDevice = this.devices[this.currentDeviceIndex];
                        // 根据设备名称判断设备类型，选择对应的图标
                        let deviceIcon;
                        if (currentDevice.includes('门')) {
                            // 门使用门的SVG图标
                            deviceIcon = `<svg t="1764677766234" class="icon device-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="66527" width="32" height="32"><path d="M761.344 119.296H226.816c-18.944 0-39.424 11.776-39.424 30.72V921.6h614.4V148.48c0.512-18.944-22.016-29.184-40.448-29.184z m-537.6 768c-2.048 0-2.048 0 0 0L221.696 163.84c0-5.12 5.12-10.24 10.24-10.24h522.24c8.704 0 13.824 5.12 13.824 13.824v720.384s0 1.536-1.536 1.536h-15.36V194.56c0-16.896-8.704-24.064-29.184-24.064H266.24c-18.944 0-27.136 8.704-27.136 24.064v692.736h-15.36z m49.152 0V204.8H716.8v682.496H272.896z" p-id="66528"></path><path d="M648.704 508.416c-16.896 0-32.256 13.824-32.256 32.256 0 16.896 13.824 32.256 32.256 32.256s32.256-13.824 32.256-32.256c0-16.896-13.824-32.256-32.256-32.256z" p-id="66529"></path></svg>`;
                        } else {
                            // 窗户使用窗户的SVG图标
                            deviceIcon = `<svg t="1764677830268" class="icon device-icon" viewBox="0 0 1086 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="69812" width="32" height="32"><path d="M1055.76489 963.11166h-49.972294V83.863892A83.965668 83.965668 0 0 0 921.928704 0H172.904054a83.965668 83.965668 0 0 0-83.863891 83.863892v879.247768H33.826375a30.53297 30.53297 0 1 0 0 60.709722H1055.76489a30.53297 30.53297 0 1 0 0-60.709722zM945.133761 83.863892V399.981911a30.227641 30.227641 0 0 0-12.518518 7.531466l-254.136089 254.136089a30.53297 30.53297 0 0 0 42.949712 42.949712l223.908448-223.908449v482.217377h-367.566074V470.971067l156.990356-156.990356a30.53297 30.53297 0 0 0-42.949712-42.949711l-113.989755 114.091532V60.709723h344.208351a23.154169 23.154169 0 0 1 23.103281 23.154169z m-795.383876 0a23.154169 23.154169 0 0 1 23.154169-23.154169h344.361017v385.122532L314.78059 648.316736a30.53297 30.53297 0 0 0 42.949711 42.949711l159.53477-159.534769v431.379982H149.749885z" fill="#7E7E7E" p-id="69813"></path></svg>`;
                        }
                        content = `
                            <div class="standby-content standby-with-device">
                                <div class="device-count">设备${this.currentDeviceIndex + 1}/${this.devices.length}</div>
                                <div class="device-icon-area">
                                    ${deviceIcon}
                                </div>
                                <div class="merged-device-name center-text">${currentDevice}</div>
                            </div>
                        `;
                    }
                    
                    // 更新屏幕动态区域内容
                    screenContent.innerHTML = content;
                },
                
                // 更新设置页面显示
                updateSettingsDisplay: function() {
                    // 计算当前页显示的设置项范围
                    const startIndex = this.settingsPage * this.settingsPerPage;
                    const endIndex = Math.min(startIndex + this.settingsPerPage, this.settingsItems.length);
                    const currentPageItems = this.settingsItems.slice(startIndex, endIndex);
                    
                    let content = `
                        <div class="settings-content">
                            <div class="settings-header">
                                <span class="settings-icon">
                                    <svg t="1764639498631" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="18379" width="12" height="12"><path d="M876.7 587.7c-44.9 6.7-84.3 33.5-106.8 72.8-22.8 39.1-26.4 86.4-9.9 128.5-38.2 34.2-83.2 60.1-132 76.1-28.2-35.4-71.2-56-116.6-55.8-45.4-0.2-88.4 20.4-116.6 55.8-48.8-16-93.7-41.9-132-76 16.6-42.1 13-89.4-9.8-128.5-22.5-39.3-61.9-66.1-106.8-72.8-10.4-50.1-10.4-101.8 0-152 44.9-6.6 84.3-33.4 106.8-72.7 22.8-39.1 26.4-86.4 9.8-128.5 38.2-34.2 83.2-60.1 132-76.1 28.3 35.4 71.2 56 116.6 55.8 46.3 0 88.7-20.8 116.6-55.8 48.8 16 93.7 41.9 132 76.1-16.6 42.1-13 89.4 9.9 128.5 22.5 39.3 61.9 66.1 106.8 72.7 10.5 50 10.5 101.7 0 151.9m65.5-197.9c-4.7-16.9-20.7-28.2-38.3-27-28.3 1.9-55.3-12.5-69.4-37-14.3-24.5-13.3-54.9 2.5-78.5 9.7-14.6 7.9-33.9-4.3-46.4-57.8-59.5-131.1-101.7-211.7-122-17-4.3-34.7 3.9-42.5 19.6-12.5 25.4-38.5 41.5-66.9 41.4-28.4 0.1-54.4-16-66.9-41.4-7.8-15.7-25.5-23.8-42.5-19.6-80.6 20.2-153.9 62.5-211.8 122-12.2 12.6-14 31.9-4.3 46.5 15.8 23.5 16.8 54 2.5 78.4-14.1 24.6-41 38.9-69.4 37-17.6-1.3-33.6 10-38.2 27-11.3 39.6-17 80.7-17 121.9 0 41.4 5.7 82.4 16.9 121.9 4.8 16.9 20.7 28.1 38.2 27 28.3-1.8 55.2 12.6 69.4 37.1 14.3 24.6 13.4 54.7-2.5 78.4-9.7 14.6-7.9 33.9 4.3 46.4 57.8 59.5 131.2 101.8 211.8 122 17 4.3 34.7-3.8 42.5-19.5 12.5-25.4 38.5-41.5 66.9-41.3 28.6 0 54.2 15.8 66.9 41.3 7.8 15.7 25.5 23.8 42.5 19.6 80.6-20.2 153.9-62.5 211.8-122 12.2-12.6 14-31.9 4.3-46.5-15.8-23.5-16.7-53.9-2.5-78.3 14-24.7 41-39.1 69.4-37.1 17.5 1 33.5-10.1 38.3-27 11.3-39.7 17-80.7 16.9-121.9 0-41.5-5.7-82.5-16.9-122" p-id="18380"></path><path d="M511.6 623.2c-61.7 0-111.9-50.1-111.9-111.5 0-61.5 50.2-111.5 111.9-111.5s111.9 50 111.9 111.5-50.2 111.5-111.9 111.5m0-297.4c-102.8 0-186.5 83.4-186.5 185.9s83.7 185.9 186.5 185.9 186.5-83.4 186.5-185.9c-0.1-102.6-83.7-185.9-186.5-185.9" p-id="18381"></path></svg>
                                </span>
                                <span class="settings-title">设置</span>
                            </div>
                            <div class="settings-list">
                        `;
                        
                        // 生成当前页的设置项列表
                        currentPageItems.forEach((item, pageIndex) => {
                            const actualIndex = startIndex + pageIndex;
                            const isSelected = actualIndex === this.settingsIndex;
                            content += `
                                <div class="settings-item ${isSelected ? 'selected' : ''}" data-index="${actualIndex}">
                                    <span class="settings-item-text">${item}</span>
                                    <span class="settings-item-arrow">›</span>
                                </div>
                            `;
                        });
                        
                        content += `
                            </div>
                        </div>
                    `;
                    
                    // 更新屏幕动态区域内容
                    screenContent.innerHTML = content;
                },
                
                // 切换到设置页面
                goToSettings: function() {
                    this.currentPage = 'settings';
                    this.settingsIndex = 0; // 默认选中第一个设置项
                    this.settingsPage = 0; // 默认显示第一页
                    this.updateSettingsDisplay();
                },
                
                // 切换回待机页面
                goToStandby: function() {
                    this.currentPage = 'standby';
                    this.updateStandbyDisplay();
                },
                
                // 选择上一个设置项
                prevSetting: function() {
                    if (this.settingsIndex === 0) {
                        // 已经是第一个设置项，循环到最后一个
                        this.settingsIndex = this.settingsItems.length - 1;
                    } else {
                        this.settingsIndex--;
                    }
                    
                    // 更新当前页码
                    this.settingsPage = Math.floor(this.settingsIndex / this.settingsPerPage);
                    this.updateSettingsDisplay();
                },
                
                // 选择下一个设置项
                nextSetting: function() {
                    if (this.settingsIndex === this.settingsItems.length - 1) {
                        // 已经是最后一个设置项，循环到第一个
                        this.settingsIndex = 0;
                    } else {
                        this.settingsIndex++;
                    }
                    
                    // 更新当前页码
                    this.settingsPage = Math.floor(this.settingsIndex / this.settingsPerPage);
                    this.updateSettingsDisplay();
                },
                
                // 确认选择当前设置项
                selectSetting: function() {
                    const selectedItem = this.settingsItems[this.settingsIndex];
                    console.log('进入设置项:', selectedItem);
                    
                    // 进入对应的子菜单
                    this.currentPage = 'submenu';
                    this.currentSubMenu = selectedItem;
                    this.subMenuIndex = 0;
                    this.subMenuPage = 0;
                    
                    // 根据不同的设置项显示不同的子菜单
                    this.updateSubMenuDisplay();
                },
                
                // 更新子菜单显示
                updateSubMenuDisplay: function() {
                    let content = '';
                    // 根据不同的子菜单显示不同的内容
                    switch (this.currentSubMenu) {
                        case '门窗重命名':
                            content = this.getModifyNameSubMenu();
                            break;
                        case '用户手册':
                            content = this.getUserManualSubMenu();
                            break;
                        case '门窗列表':
                            // 特殊处理管理门窗子菜单，动态生成设备列表
                            content = this.getDoorWindowManagementSubMenu();
                            break;
                        default:
                            content = this.getNormalSubMenu();
                            break;
                    }
                    
                    // 更新屏幕动态区域内容
                    screenContent.innerHTML = content;
                },
                
                // 生成普通子菜单（带菜单项列表）
                getNormalSubMenu: function() {
                    // 计算当前页显示的子菜单项范围
                    const subItems = this.subMenuItems[this.currentSubMenu] || [];
                    const startIndex = this.subMenuPage * this.subMenuPerPage;
                    const endIndex = Math.min(startIndex + this.subMenuPerPage, subItems.length);
                    const currentPageItems = subItems.slice(startIndex, endIndex);
                    
                    let content = `
                        <div class="settings-content">
                            <div class="settings-header" style="${this.currentSubMenu === '门窗配对' ? 'justify-content: center;' : ''}">
                                <span class="settings-icon">
                                    ${this.currentSubMenu === '门窗配对' ? '' : this.currentSubMenu === '自动关门感应' ? `<svg t="1764666656084" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="15870" width="12" height="12"><path d="M307.2 691.2c-9.216 0-17.92-4.096-24.064-11.776C245.248 631.296 225.28 573.44 225.28 512c0-62.976 22.016-124.928 62.464-173.056 10.752-12.8 30.208-14.848 43.008-4.096 12.8 10.752 14.848 30.208 4.096 43.008-30.72 37.888-48.128 85.504-48.128 134.144 0 47.616 15.36 92.16 44.544 129.536 10.24 13.312 8.192 32.768-5.12 43.008-5.632 4.608-12.288 6.656-18.944 6.656zM716.8 691.2c-6.656 0-13.312-2.048-18.944-6.656-13.312-10.24-15.872-29.696-5.12-43.008 29.184-37.376 44.544-81.92 44.544-129.536 0-48.64-17.408-96.256-48.128-134.144-10.752-12.8-9.216-32.256 4.096-43.008 12.8-10.752 32.256-9.216 43.008 4.096 40.448 48.64 62.464 110.08 62.464 173.056 0 61.44-19.968 119.296-57.856 167.424-6.144 7.68-14.848 11.776-24.064 11.776z" fill="#040000" p-id="15871"></path><path d="M818.688 798.72c-7.168 0-14.336-2.56-20.48-7.68-12.8-11.264-13.824-30.72-2.56-43.52 57.344-65.024 89.088-148.992 89.088-235.52 0-89.088-33.28-174.592-93.184-240.64-11.264-12.288-10.752-31.744 2.048-43.52 12.8-11.264 31.744-10.752 43.52 2.048 70.144 77.312 109.056 177.152 109.056 281.6 0 101.888-36.864 200.192-103.936 276.48-6.656 7.168-14.848 10.752-23.552 10.752zM205.312 798.72c-8.704 0-16.896-3.584-23.04-10.24-67.072-76.288-103.936-174.592-103.936-276.48 0-104.448 38.912-204.8 109.056-281.6 11.264-12.288 30.72-13.312 43.52-2.048 12.288 11.264 13.312 30.72 2.048 43.52-59.904 66.048-93.184 151.04-93.184 240.64 0 87.04 31.744 170.496 89.088 235.52 11.264 12.8 9.728 32.256-2.56 43.52-6.656 4.608-13.824 7.168-20.992 7.168zM558.08 650.24H460.8c-50.688 0-92.16-41.472-92.16-92.16V460.8c0-50.688 41.472-92.16 92.16-92.16h97.28c50.688 0 92.16 41.472 92.16 92.16v97.28c0 50.688-41.472 92.16-92.16 92.16zM460.8 430.08c-16.896 0-30.72 13.824-30.72 30.72v97.28c0 16.896 13.824 30.72 30.72 30.72h97.28c16.896 0 30.72-13.824 30.72-30.72V460.8c0-16.896-13.824-30.72-30.72-30.72H460.8z" fill="#040000" p-id="15872"></path></svg>` : this.currentSubMenu === '童锁' ? `<svg t="1764666958358" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="17757" width="12" height="12"><path d="M512 34.133333c145.92 0 264.533333 121.002667 264.533333 269.653334 0 9.258667-0.512 18.602667-1.493333 27.946666l-0.810667 6.101334 0.64 0.128c69.717333 17.621333 121.514667 78.293333 128.768 151.04l0.682667 8.746666 0.213333 8.917334v266.666666c0 92.970667-72.106667 169.130667-162.474666 173.653334l-8.533334 0.213333H290.56c-91.477333 0-166.4-73.386667-170.837333-165.162667l-0.213334-8.661333v-266.709333c0-77.44 50.389333-144.512 121.386667-166.4l8.917333-2.474667-1.152-9.514667-0.768-10.496-0.384-13.952C247.466667 155.136 366.08 34.133333 512 34.133333z m221.568 377.344H290.517333c-49.237333 0-89.770667 39.04-93.184 88.362667l-0.256 6.826667v266.666666c0 50.261333 38.4 91.477333 86.784 94.976l6.656 0.213334h443.050667c49.194667 0 89.685333-39.04 93.098667-88.362667l0.256-6.826667v-266.666666c0-52.522667-41.941333-95.189333-93.354667-95.189334zM512 460.8c86.869333 0 157.824 64.128 157.824 143.402667 0 58.496-38.613333 110.08-96.725333 132.010666l-2.176 0.725334v28.202666c0 26.282667-20.352 47.957333-47.104 52.949334l-5.845334 0.853333-5.973333 0.256c-30.293333 0-55.552-21.12-58.581333-48.469333l-0.298667-5.546667-0.042667-28.202667-2.133333-0.682666c-52.778667-19.925333-89.472-64.213333-95.872-115.925334l-0.725333-8.234666-0.256-7.936c0-79.274667 70.997333-143.402667 157.866666-143.402667z m0 72.362667c-44.117333 0-79.658667 32.085333-79.658667 71.04 0 32.512 24.618667 60.586667 59.776 68.565333l18.56 3.413333 14.378667-2.133333c38.741333-5.802667 66.517333-35.285333 66.517333-69.845333 0-38.954667-35.541333-71.04-79.573333-71.04z m0-422.613334c-103.509333 0-187.776 86.656-187.776 193.28 0 7.850667 0.469333 15.872 1.493333 23.893334l0.810667 5.077333h370.858667l1.152-7.936c0.426667-3.541333 0.682667-7.082667 0.853333-10.581333l0.298667-10.453334c0-106.624-84.266667-193.28-187.733334-193.28z" fill="#262626" p-id="17758"></path></svg>` : `<svg t="1764641037500" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="20214" width="12" height="12"><path d="M512 954.88c-243.712 0-442.88-199.168-442.88-442.88s199.168-442.88 442.88-442.88 442.88 199.168 442.88 442.88-199.168 442.88-442.88 442.88z m0-63.488c208.896 0 379.392-170.496 379.392-379.392s-170.496-379.392-379.392-379.392-379.392 170.496-379.392 379.392 170.496 379.392 379.392 379.392z m192-360.96h-363.52c-14.336 0-26.624-11.776-26.624-26.624V496.64c0-14.336 11.776-26.624 26.624-26.624h363.52c14.336 0 26.624 11.776 26.624 26.624v7.168c0 14.336-12.288 26.624-26.624 26.624z m-212.48 171.52l1.024-363.52c0-14.336 11.776-26.624 26.624-26.624h7.168c14.336 0 26.624 11.776 26.624 26.624l-1.024 363.52c0 14.336-11.776 26.624-26.624 26.624h-7.168c-14.848 0-26.624-11.776-26.624-26.624z" p-id="20215"></path></svg>`}
                                </span>
                                <span class="settings-title">${this.currentSubMenu === '门窗配对' ? '请选择要配对的门窗' : this.currentSubMenu}</span>
                            </div>
                            <div class="settings-list">
                    `;
                    
                    // 生成当前页的子菜单项列表
                    currentPageItems.forEach((item, pageIndex) => {
                        const actualIndex = startIndex + pageIndex;
                        const isSelected = actualIndex === this.subMenuIndex;
                        // 为"更多"子菜单中的特定选项添加箭头
                        const isMoreSubMenu = this.currentSubMenu === '更多';
                        const needsArrow = isMoreSubMenu && ['显示模式', '语言', '恢复出厂设置'].includes(item);
                        // 添加门窗子菜单、自动关门感应子菜单和童锁子菜单选项文字居中对齐，字体14px
                        if (this.currentSubMenu === '门窗配对' || this.currentSubMenu === '自动关门感应' || this.currentSubMenu === '童锁') {
                            // 对于门窗配对、自动关门感应和童锁子菜单，使用block布局实现居中，字体14px
                            content += `
                                <div class="settings-item ${isSelected ? 'selected' : ''}" data-index="${actualIndex}" style="display: block; text-align: center; text-indent: 0; font-size: 16px;">
                                    ${item}
                                </div>
                            `;
                        } else {
                            // 其他子菜单使用带箭头的样式（如果需要）
                            content += `
                                <div class="settings-item ${isSelected ? 'selected' : ''}" data-index="${actualIndex}" style="display: flex; justify-content: space-between; align-items: center;">
                                    ${item}
                                    ${needsArrow ? '<span class="settings-item-arrow">›</span>' : ''}
                                </div>
                            `;
                        }
                    });
                        
                        content += `
                            </div>
                        </div>
                    `;
                    
                    return content;
                },
                
                // 生成门窗重命名子菜单（带二维码）
                getModifyNameSubMenu: function() {
                    // 虚拟二维码SVG
                    const virtualQRCode = `<svg width="80" height="80" xmlns="http://www.w3.org/2000/svg">
                        <rect width="80" height="80" fill="white" stroke="#ccc" stroke-width="1"/>
                        <rect x="10" y="10" width="20" height="20" fill="black"/>
                        <rect x="50" y="10" width="20" height="20" fill="black"/>
                        <rect x="10" y="50" width="20" height="20" fill="black"/>
                        <rect x="50" y="50" width="20" height="20" fill="black"/>
                        <rect x="30" y="30" width="20" height="20" fill="black"/>
                        <rect x="20" y="20" width="10" height="10" fill="black"/>
                        <rect x="50" y="20" width="10" height="10" fill="black"/>
                        <rect x="20" y="50" width="10" height="10" fill="black"/>
                        <rect x="50" y="50" width="10" height="10" fill="black"/>
                        <rect x="30" y="10" width="10" height="10" fill="black"/>
                        <rect x="30" y="60" width="10" height="10" fill="black"/>
                        <rect x="10" y="30" width="10" height="10" fill="black"/>
                        <rect x="60" y="30" width="10" height="10" fill="black"/>
                    </svg>`;
                    
                    let content = `
                        <div class="settings-content">
                            <div class="settings-header" style="justify-content: center;">
                                <span class="settings-title" style="font-size: 12px;">微信扫码重命名</span>
                            </div>
                            <div class="qrcode-area">
                                ${virtualQRCode}
                            </div>
                            <div class="settings-item selected" style="font-size: 16px; text-align: center; text-indent: 0; justify-content: center;">
                                按OK开始连接手机
                            </div>
                        </div>
                    `;
                    
                    return content;
                },
                
                // 生成用户手册子菜单（带二维码）
                getUserManualSubMenu: function() {
                    // 虚拟二维码SVG
                    const virtualQRCode = `<svg width="80" height="80" xmlns="http://www.w3.org/2000/svg">
                        <rect width="80" height="80" fill="white" stroke="#ccc" stroke-width="1"/>
                        <rect x="10" y="10" width="20" height="20" fill="black"/>
                        <rect x="50" y="10" width="20" height="20" fill="black"/>
                        <rect x="10" y="50" width="20" height="20" fill="black"/>
                        <rect x="50" y="50" width="20" height="20" fill="black"/>
                        <rect x="30" y="30" width="20" height="20" fill="black"/>
                        <rect x="20" y="20" width="10" height="10" fill="black"/>
                        <rect x="50" y="20" width="10" height="10" fill="black"/>
                        <rect x="20" y="50" width="10" height="10" fill="black"/>
                        <rect x="50" y="50" width="10" height="10" fill="black"/>
                        <rect x="30" y="10" width="10" height="10" fill="black"/>
                        <rect x="30" y="60" width="10" height="10" fill="black"/>
                        <rect x="10" y="30" width="10" height="10" fill="black"/>
                        <rect x="60" y="30" width="10" height="10" fill="black"/>
                    </svg>`;
                    
                    let content = `
                        <div class="settings-content">
                            <!-- 第1行：空行 -->
                            <div style="height: 24px; width: 100%;"></div>
                            <!-- 第2-5行合并：二维码 -->
                            <div class="qrcode-area" style="height: 96px; display: flex; justify-content: center; align-items: center;">
                                ${virtualQRCode}
                            </div>
                            <!-- 第6行：扫码查看手册，字体16px，左右居中 -->
                            <div style="height: 24px; width: 100%; display: flex; justify-content: center; align-items: center;">
                                <span style="text-align: center; font-size: 16px;">扫码查看手册</span>
                            </div>
                        </div>
                    `;
                    
                    return content;
                },
                
                // 生成管理门窗子菜单（动态设备列表）
                getDoorWindowManagementSubMenu: function() {
                    // 动态生成设备列表，包含所有已添加的设备和一个"返回"选项
                    const devices = this.devices;
                    // 创建子菜单项数组：设备列表 + ["返回"]
                    const subItems = [...devices, '返回'];
                    
                    // 计算当前页显示的子菜单项范围
                    const startIndex = this.subMenuPage * this.subMenuPerPage;
                    const endIndex = Math.min(startIndex + this.subMenuPerPage, subItems.length);
                    const currentPageItems = subItems.slice(startIndex, endIndex);
                    
                    // 用户提供的SVG图标，已清理格式
                    const managementIcon = `<svg t="1764661199765" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5605" width="16" height="16"><path d="M227.5 473.8c-27.2 0-49.2 22-49.2 49.3 0 27.2 22 49.2 49.2 49.2 27.2 0 49.2-22 49.2-49.2 0-27.2-22.1-49.3-49.2-49.3z m0 216.6c-27.2 0-49.2 22-49.2 49.2 0 27.2 22 49.3 49.2 49.3 27.2 0 49.2-22 49.2-49.3 0-27.1-22.1-49.2-49.2-49.2z m0-433.2c-27.2 0-49.2 22-49.2 49.2 0 27.2 22 49.2 49.2 49.2 27.2 0 49.2-22 49.2-49.2 0-27.1-22.1-49.2-49.2-49.2z m600.6 19.7H375.2c-10.9 0-19.7 8.8-19.7 19.7v19.7c0 10.9 8.8 19.7 19.7 19.7h452.9c10.9 0 19.7-8.8 19.7-19.7v-19.7c0-10.9-8.8-19.7-19.7-19.7z m0 433.2H375.2c-10.9 0-19.7 8.8-19.7 19.7v19.7c0 10.9 8.8 19.7 19.7 19.7h452.9c10.9 0 19.7-8.8 19.7-19.7v-19.7c0-10.8-8.8-19.7-19.7-19.7z m0-216.5H375.2c-10.9 0-19.7 8.8-19.7 19.7V533c0 10.8 8.8 19.7 19.7 19.7h452.9c10.9 0 19.7-8.8 19.7-19.7v-19.7c0-10.9-8.8-19.7-19.7-19.7z" fill="#666666" p-id="5606"></path></svg>`;
                    
                    let content = `
                        <div class="settings-content">
                            <div class="settings-header">
                                <span class="settings-icon">
                                    ${managementIcon}
                                </span>
                                <span class="settings-title">${this.currentSubMenu}</span>
                            </div>
                            <div class="settings-list">
                    `;
                    
                    // 生成当前页的子菜单项列表
                    currentPageItems.forEach((item, pageIndex) => {
                        const actualIndex = startIndex + pageIndex;
                        const isSelected = actualIndex === this.subMenuIndex;
                        const isReturnItem = item === '返回';
                        const displayText = isReturnItem ? item : `${actualIndex + 1}-${item}`;
                        content += `
                            <div class="settings-item ${isSelected ? 'selected' : ''}" data-index="${actualIndex}">
                                <span>${displayText}</span>
                                ${!isReturnItem ? '<span class="settings-item-arrow">›</span>' : ''}
                            </div>
                        `;
                    });
                    
                    content += `
                            </div>
                        </div>
                    `;
                    
                    return content;
                },
                
                // 选择上一个子菜单项
                prevSubMenuItem: function() {
                    let subItems;
                    if (this.currentSubMenu === '门窗列表') {
                        // 门窗列表子菜单使用动态生成的设备列表
                        subItems = [...this.devices, '返回'];
                    } else {
                        subItems = this.subMenuItems[this.currentSubMenu] || [];
                    }
                    if (this.subMenuIndex === 0) {
                        // 已经是第一个子菜单项，循环到最后一个
                        this.subMenuIndex = subItems.length - 1;
                    } else {
                        this.subMenuIndex--;
                    }
                    
                    // 更新当前页码
                    this.subMenuPage = Math.floor(this.subMenuIndex / this.subMenuPerPage);
                    this.updateSubMenuDisplay();
                },
                
                // 选择下一个子菜单项
                nextSubMenuItem: function() {
                    let subItems;
                    if (this.currentSubMenu === '门窗列表') {
                        // 门窗列表子菜单使用动态生成的设备列表
                        subItems = [...this.devices, '返回'];
                    } else {
                        subItems = this.subMenuItems[this.currentSubMenu] || [];
                    }
                    if (this.subMenuIndex === subItems.length - 1) {
                        // 已经是最后一个子菜单项，循环到第一个
                        this.subMenuIndex = 0;
                    } else {
                        this.subMenuIndex++;
                    }
                    
                    // 更新当前页码
                    this.subMenuPage = Math.floor(this.subMenuIndex / this.subMenuPerPage);
                    this.updateSubMenuDisplay();
                },
                
                // 确认选择当前子菜单项
                selectSubMenuItem: function() {
                    let subItems;
                    let selectedItem;
                    
                    if (this.currentSubMenu === '门窗列表') {
                        // 门窗列表子菜单使用动态生成的设备列表
                        subItems = [...this.devices, '返回'];
                        selectedItem = subItems[this.subMenuIndex];
                    } else {
                        // 其他子菜单使用预定义的子菜单项列表
                        subItems = this.subMenuItems[this.currentSubMenu] || [];
                        selectedItem = subItems[this.subMenuIndex];
                    }
                    
                    console.log('选择子菜单项:', selectedItem);
                    
                    // 处理返回选项
                    if (selectedItem === '返回' || selectedItem === '返回上一页') {
                        // 返回设置页面
                        this.currentPage = 'settings';
                        this.updateSettingsDisplay();
                        return;
                    }
                    
                    // 处理添加门窗子菜单选项
                    if (this.currentSubMenu === '门窗配对') {
                        if (selectedItem === '取消') {
                            // 返回设置页面
                            this.currentPage = 'settings';
                            this.updateSettingsDisplay();
                            return;
                        } else {
                            // 保存选择的门窗类型，重置同控门窗标志
                            this.currentDoorWindowType = selectedItem;
                            this.isAddingSameControlDevice = false;
                            // 进入蓝牙配对页面
                            this.currentPage = 'bluetoothPairing';
                            this.updateBluetoothPairingDisplay();
                            return;
                        }
                    }
                    
                    // 处理管理门窗子菜单选项
                    if (this.currentSubMenu === '门窗列表') {
                        // 保存当前选择的设备索引
                        this.currentDeviceIndex = this.subMenuIndex;
                        // 进入门窗信息页面
                        this.currentPage = 'doorWindowInfo';
                        // 重置门窗信息页面的选中索引
                        this.doorWindowInfoIndex = 0;
                        this.updateDoorWindowInfoDisplay();
                        return;
                    }
                    
                    // 处理门窗重命名子菜单选项
                    if (this.currentSubMenu === '门窗重命名') {
                        // 进入蓝牙连接手机页面
                        this.currentPage = 'bluetoothConnectPhone';
                        this.updateBluetoothConnectPhoneDisplay();
                        return;
                    }
                    
                    // 处理童锁子菜单选项
                if (this.currentSubMenu === '童锁') {
                    switch (selectedItem) {
                        case '关闭':
                            this.isChildLockEnabled = false;
                            this.currentPage = 'childLockClosed';
                            this.updateChildLockClosedDisplay();
                            break;
                        case '开启':
                            this.isChildLockEnabled = true;
                            this.currentPage = 'childLockOpened';
                            this.updateChildLockOpenedDisplay();
                            break;
                        case '返回':
                            this.currentPage = 'settings';
                            this.updateSettingsDisplay();
                            break;
                    }
                    return;
                }
                
                // 处理自动关门感应子菜单选项
                if (this.currentSubMenu === '自动关门感应') {
                    switch (selectedItem) {
                        case '开启':
                            this.isAutoCloseEnabled = true;
                            this.currentPage = 'autoCloseEnabled';
                            this.updateAutoCloseEnabledDisplay();
                            break;
                        case '关闭':
                            this.isAutoCloseEnabled = false;
                            this.currentPage = 'autoCloseDisabled';
                            this.updateAutoCloseDisabledDisplay();
                            break;
                        case '使用说明':
                            // 进入使用说明页面
                            this.currentPage = 'autoCloseManual';
                            this.updateAutoCloseManualDisplay();
                            break;
                        case '返回':
                            this.currentPage = 'settings';
                            this.updateSettingsDisplay();
                            break;
                    }
                    return;
                }
                
                // 处理显示模式选项
                if (selectedItem === '显示模式') {
                    // 进入显示模式页面
                    this.currentPage = 'displayMode';
                    this.displayModeIndex = 0; // 默认选中"流畅"
                    this.updateDisplayModeDisplay();
                    return;
                }
                
                // 处理语言设置选项
                if (selectedItem === '语言') {
                    // 进入语言设置页面
                    this.currentPage = 'language';
                    this.languageIndex = 0; // 默认选中"中文"
                    this.updateLanguageDisplay();
                    return;
                }
                
                // 处理恢复出厂设置选项
                if (selectedItem === '恢复出厂设置') {
                    // 进入恢复出厂设置页面
                    this.currentPage = 'resetFactory';
                    this.resetFactoryIndex = 0; // 默认选中"取消"
                    this.updateResetFactoryDisplay();
                    return;
                }
                
                // 处理其他子菜单项
                console.log('处理子菜单项:', selectedItem);
                // 这里可以添加处理具体子菜单项的逻辑
                // 目前暂时返回设置页面
                this.currentPage = 'settings';
                this.updateSettingsDisplay();
                },
                
                // 处理OK键点击 - 用于蓝牙配对页面
                handleBluetoothPairingOK: function() {
                    // 清除定时器
                    if (this.countdownInterval) {
                        clearInterval(this.countdownInterval);
                        this.countdownInterval = null;
                    }
                    if (this.broadcastInterval) {
                        clearInterval(this.broadcastInterval);
                        this.broadcastInterval = null;
                    }
                    
                    // 只有当不是添加同控门窗且不是重新配对时，才生成唯一设备名称并添加设备
                    if (this.currentDoorWindowType && !this.isAddingSameControlDevice && !this.isRePairing) {
                        const uniqueName = this.generateUniqueDeviceName(this.currentDoorWindowType);
                        this.addDevice(uniqueName);
                    }
                    
                    // 保存当前标志状态，用于后续判断
                    const wasRePairing = this.isRePairing;
                    const wasAddingSameControl = this.isAddingSameControlDevice;
                    const wasFromDeviceInfo = this.isFromDeviceInfo;
                    
                    // 重置标志
                    this.isAddingSameControlDevice = false;
                    this.isRePairing = false;
                    this.rePairingDeviceIndex = -1;
                    this.isFromDeviceInfo = false;
                    
                    if (wasRePairing) {
                        // 重新配对完成后，直接返回门窗信息页面
                        this.currentPage = 'doorWindowInfo';
                        this.updateDoorWindowInfoDisplay();
                    } else if (wasAddingSameControl) {
                        if (wasFromDeviceInfo) {
                            // 从设备信息页面进入的同控设备添加，完成后返回设备信息页面
                            this.currentPage = 'doorWindowInfo';
                            this.updateDoorWindowInfoDisplay();
                        } else {
                            // 从初始添加设备流程进入的同控设备添加，完成后继续询问是否添加更多同控设备
                            this.currentPage = 'continuePairing';
                            this.continuePairingIndex = 1; // 默认选中第二个选项（取消）
                            this.updateContinuePairingDisplay();
                        }
                    } else {
                        // 首次添加设备，进入添加更多设备页面
                        this.currentPage = 'continuePairing';
                        this.continuePairingIndex = 1; // 默认选中第二个选项（取消）
                        this.updateContinuePairingDisplay();
                    }
                },
                
                // 更新与手机通信中页面显示
                updatePhoneCommunicatingDisplay: function() {
                    let content = `
                        <div class="settings-content">
                            <div class="settings-header" style="justify-content: center;">
                                <span class="settings-icon"></span>
                                <span class="settings-title">与手机通信中</span>
                            </div>
                            <div style="flex: 1; display: flex; flex-direction: column; justify-content: center; align-items: center; width: 100%;">
                                <!-- 通信中提示 -->
                                <div style="height: 72px; display: flex; justify-content: center; align-items: center;">
                                    <div id="broadcast-animation" class="broadcast-container">
                                        <svg t="1764666231803" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="11613" width="32" height="32">
                                            <path d="M820.409449 797.228346q0 25.19685-10.07874 46.866142t-27.716535 38.299213-41.322835 26.204724-50.897638 9.574803l-357.795276 0q-27.212598 0-50.897638-9.574803t-41.322835-26.204724-27.716535-38.299213-10.07874-46.866142l0-675.275591q0-25.19685 10.07874-47.370079t27.716535-38.80315 41.322835-26.204724 50.897638-9.574803l357.795276 0q27.212598 0 50.897638 9.574803t41.322835 26.204724 27.716535 38.80315 10.07874 47.370079l0 675.275591zM738.771654 170.330709l-455.559055 0 0 577.511811 455.559055 0 0-577.511811zM510.992126 776.062992q-21.165354 0-36.787402 15.11811t-15.622047 37.291339q0 21.165354 15.622047 36.787402t36.787402 15.622047q22.173228 0 37.291339-15.622047t15.11811-36.787402q0-22.173228-15.11811-37.291339t-37.291339-15.11811zM591.622047 84.661417q0-8.062992-5.03937-12.598425t-11.086614-4.535433l-128 0q-5.03937 0-10.582677 4.535433t-5.543307 12.598425 5.03937 12.598425 11.086614 4.535433l128 0q6.047244 0 11.086614-4.535433t5.03937-12.598425z" p-id="11614"></path>
                                        </svg>
                                    </div>
                                </div>
                                <!-- 通信中提示文本 -->
                                <div style="height: 24px; line-height: 24px; font-size: 16px; text-align: center; width: 100%;">
                                    请勿断开连接
                                </div>
                            </div>
                        </div>
                    `;
                    
                    // 更新屏幕动态区域内容
                    screenContent.innerHTML = content;
                    
                    // 启动广播动画
                    this.broadcastInterval = setInterval(() => {
                        const broadcastAnimation = document.getElementById('broadcast-animation');
                        if (broadcastAnimation) {
                            broadcastAnimation.classList.toggle('broadcast');
                        }
                    }, 500);
                },
                
                // 更新蓝牙连接手机页面显示
                updateBluetoothConnectPhoneDisplay: function() {
                    // 重置倒计时
                    this.pairingCountdown = 60;
                    
                    // 清除之前的定时器
                    if (this.countdownInterval) {
                        clearInterval(this.countdownInterval);
                        this.countdownInterval = null;
                    }
                    if (this.broadcastInterval) {
                        clearInterval(this.broadcastInterval);
                        this.broadcastInterval = null;
                    }
                    
                    let content = `
                        <div class="settings-content">
                            <div class="settings-header" style="justify-content: center;">
                                <span class="settings-icon"></span>
                                <span class="settings-title">请同时在手机上发起连接</span>
                            </div>
                            <div style="flex: 1; display: flex; flex-direction: column; width: 100%;">
                                <!-- 第2-4行合并：波纹动画区域 -->
                                <div style="height: 72px; display: flex; justify-content: center; align-items: center;">
                                    <div id="broadcast-animation" class="broadcast-container">
                                        <svg t="1764655440037" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5797" width="32" height="32">
                                            <path d="M756.736 679.808l0.096-0.112L561.168 512l195.648-167.696-0.096-0.112c6.848-5.872 11.28-14.48 11.28-24.192a31.84 31.84 0 0 0-11.264-24.192l0.096-0.112-224-192-0.096 0.112C527.136 99.008 519.952 96 512 96a32 32 0 0 0-32 32v314.416l-171.168-146.72-0.096 0.112c-5.6-4.8-12.784-7.808-20.736-7.808a32 32 0 0 0-32 32c0 9.712 4.432 18.32 11.264 24.192l-0.096 0.112L462.832 512 267.168 679.696l0.096 0.112A31.84 31.84 0 0 0 256 704a32 32 0 0 0 32 32c7.952 0 15.136-3.008 20.736-7.808l0.096 0.112L480 581.584V896a32 32 0 0 0 32 32c7.952 0 15.136-3.008 20.736-7.808l0.096 0.112 224-192-0.096-0.112A31.84 31.84 0 0 0 768 704a31.84 31.84 0 0 0-11.264-24.192zM686.832 704L544 826.416V581.584L686.832 704zM544 442.416V197.584L686.832 320 544 442.416z" fill="#231815" p-id="5798"></path>
                                        </svg>
                                    </div>
                                </div>
                                <!-- 第5行：60s倒计时 -->
                                <div style="height: 24px; line-height: 24px; font-size: 16px; text-align: center; width: 100%; display: flex; justify-content: center; align-items: center;">
                                    <span id="countdown-display">60</span>
                                </div>
                                <!-- 占位行：调整间距 -->
                                <div style="flex: 1;"></div>
                                <!-- 第6行：底部提示语 -->
                                <div style="height: 24px; line-height: 24px; font-size: 16px; text-align: center; width: 100%;">
                                    蓝牙连接中
                                </div>
                            </div>
                        </div>
                    `;
                    
                    // 更新屏幕动态区域内容
                    screenContent.innerHTML = content;
                    
                    // 启动倒计时
                    this.countdownInterval = setInterval(() => {
                        this.pairingCountdown--;
                        
                        // 更新倒计时显示
                        const countdownDisplay = document.getElementById('countdown-display');
                        if (countdownDisplay) {
                            countdownDisplay.textContent = this.pairingCountdown;
                        }
                        
                        // 倒计时到57秒，自动跳转到与手机通信中的页面
                        if (this.pairingCountdown === 57) {
                            clearInterval(this.countdownInterval);
                            this.countdownInterval = null;
                            if (this.broadcastInterval) {
                                clearInterval(this.broadcastInterval);
                                this.broadcastInterval = null;
                            }
                            
                            this.currentPage = 'phoneCommunicating';
                            this.updatePhoneCommunicatingDisplay();
                        }
                    }, 1000);
                    
                    // 启动广播动画
                    this.broadcastInterval = setInterval(() => {
                        const broadcastAnimation = document.getElementById('broadcast-animation');
                        if (broadcastAnimation) {
                            broadcastAnimation.classList.toggle('broadcast');
                        }
                    }, 500);
                },
                
                // 生成唯一设备名称
                generateUniqueDeviceName: function(baseName) {
                    // 检查是否已存在同名设备
                    const existingDevices = this.devices.filter(device => device === baseName);
                    
                    if (existingDevices.length === 0) {
                        return baseName;
                    } else {
                        // 检查是否已存在带序号的同名设备
                        const regex = new RegExp(`^${baseName}(\\d+)$`);
                        const numberedDevices = this.devices.filter(device => regex.test(device));
                        
                        if (numberedDevices.length === 0) {
                            return `${baseName}1`;
                        } else {
                            // 找到最大序号
                            let maxNumber = 0;
                            numberedDevices.forEach(device => {
                                const match = device.match(regex);
                                if (match) {
                                    const number = parseInt(match[1]);
                                    if (number > maxNumber) {
                                        maxNumber = number;
                                    }
                                }
                            });
                            return `${baseName}${maxNumber + 1}`;
                        }
                    }
                },
                
                // 添加设备
                addDevice: function(name) {
                    this.devices.push(name);
                    this.updateStandbyDisplay();
                },
                
                // 移除设备
                removeDevice: function(index) {
                    if (index >= 0 && index < this.devices.length) {
                        this.devices.splice(index, 1);
                        if (this.currentDeviceIndex >= this.devices.length) {
                            this.currentDeviceIndex = Math.max(0, this.devices.length - 1);
                        }
                        this.updateStandbyDisplay();
                    }
                },
                
                // 配对倒计时变量
                pairingCountdown: 60,
                countdownInterval: null,
                // 广播动画变量
                broadcastInterval: null,
                
                // 更新蓝牙配对页面显示
                updateBluetoothPairingDisplay: function() {
                    // 重置倒计时
                    this.pairingCountdown = 60;
                    
                    // 清除之前的定时器
                    if (this.countdownInterval) {
                        clearInterval(this.countdownInterval);
                        this.countdownInterval = null;
                    }
                    if (this.broadcastInterval) {
                        clearInterval(this.broadcastInterval);
                        this.broadcastInterval = null;
                    }
                    
                    let content = `
                        <div class="settings-content">
                            <div class="settings-header" style="justify-content: center;">
                                <span class="settings-icon"></span>
                                <span class="settings-title">请注意门窗设备提示</span>
                            </div>
                            <div style="flex: 1; display: flex; flex-direction: column; width: 100%;">
                                <!-- 第2-4行合并：波纹动画区域 -->
                                <div style="height: 72px; display: flex; justify-content: center; align-items: center;">
                                    <div id="broadcast-animation" class="broadcast-container">
                                        <svg t="1764655440037" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5797" width="32" height="32">
                                            <path d="M756.736 679.808l0.096-0.112L561.168 512l195.648-167.696-0.096-0.112c6.848-5.872 11.28-14.48 11.28-24.192a31.84 31.84 0 0 0-11.264-24.192l0.096-0.112-224-192-0.096 0.112C527.136 99.008 519.952 96 512 96a32 32 0 0 0-32 32v314.416l-171.168-146.72-0.096 0.112c-5.6-4.8-12.784-7.808-20.736-7.808a32 32 0 0 0-32 32c0 9.712 4.432 18.32 11.264 24.192l-0.096 0.112L462.832 512 267.168 679.696l0.096 0.112A31.84 31.84 0 0 0 256 704a32 32 0 0 0 32 32c7.952 0 15.136-3.008 20.736-7.808l0.096 0.112L480 581.584V896a32 32 0 0 0 32 32c7.952 0 15.136-3.008 20.736-7.808l0.096 0.112 224-192-0.096-0.112A31.84 31.84 0 0 0 768 704a31.84 31.84 0 0 0-11.264-24.192zM686.832 704L544 826.416V581.584L686.832 704zM544 442.416V197.584L686.832 320 544 442.416z" fill="#231815" p-id="5798"></path>
                                        </svg>
                                    </div>
                                </div>
                                <!-- 第5行：60s倒计时 -->
                                <div style="height: 24px; line-height: 24px; font-size: 12px; text-align: center; width: 100%; display: flex; justify-content: center; align-items: center;">
                                    <span id="countdown-display">60</span>
                                </div>
                                <!-- 占位行：调整间距 -->
                                <div style="flex: 1;"></div>
                            </div>
                        </div>
                    `;
                    
                    // 更新屏幕动态区域内容
                    screenContent.innerHTML = content;
                    
                    // 启动倒计时
                    this.startCountdown();
                    // 启动广播动画
                    this.startBroadcastAnimation();
                },
                
                // 启动倒计时
                startCountdown: function() {
                    // 清除之前的定时器
                    if (this.countdownInterval) {
                        clearInterval(this.countdownInterval);
                    }
                    
                    // 更新初始显示
                    this.updateCountdownDisplay();
                    
                    // 设置定时器，每秒更新一次
                    this.countdownInterval = setInterval(() => {
                        this.pairingCountdown--;
                        this.updateCountdownDisplay();
                        
                        // 倒计时到57秒时，根据配对类型执行不同逻辑
                        if (this.pairingCountdown === 57) {
                            // 区分两种情况：
                            // 1. isRePairing || (isAddingSameControlDevice && isFromDeviceInfo) - 重新配对或从设备信息页面进入的同控设备添加
                            // 2. 其他情况 - 普通添加门窗或从首次添加流程进入的同控设备添加
                            if (this.isRePairing || (this.isAddingSameControlDevice && this.isFromDeviceInfo)) {
                                // 对于重新配对或从设备信息页面进入的同控设备添加，跳转到配对成功页面
                                this.showPairingSuccessPage();
                            } else {
                                // 对于普通添加门窗或从首次添加流程进入的同控设备添加，保持原有逻辑不变
                                this.handleBluetoothPairingOK();
                            }
                        }
                        
                        // 取消配对超时逻辑，移除原有的超时处理
                        // if (this.pairingCountdown <= 0) {
                        //     this.countdownEnd();
                        // }
                    }, 1000);
                },
                
                // 启动广播动画
                startBroadcastAnimation: function() {
                    // 清除之前的定时器
                    if (this.broadcastInterval) {
                        clearInterval(this.broadcastInterval);
                        this.broadcastInterval = null;
                    }
                    
                    // CSS动画会自动运行，这里可以保留空方法或做其他初始化
                },
                
                // 更新倒计时显示
                updateCountdownDisplay: function() {
                    const countdownElement = document.getElementById('countdown-display');
                    if (countdownElement) {
                        countdownElement.textContent = this.pairingCountdown;
                    }
                },
                
                // 倒计时结束处理
                countdownEnd: function() {
                    // 清除定时器
                    if (this.countdownInterval) {
                        clearInterval(this.countdownInterval);
                        this.countdownInterval = null;
                    }
                    // 清除广播动画定时器
                    if (this.broadcastInterval) {
                        clearInterval(this.broadcastInterval);
                        this.broadcastInterval = null;
                    }
                    
                    // 无论当前在哪个子页面，都跳转到配对结果超时页面
                    this.currentPage = 'pairingTimeout';
                    this.updatePairingTimeoutDisplay();
                },
                
                // 显示配对成功页面（用于重新配对和添加同控门窗）
                showPairingSuccessPage: function() {
                    // 清除定时器
                    if (this.countdownInterval) {
                        clearInterval(this.countdownInterval);
                        this.countdownInterval = null;
                    }
                    if (this.broadcastInterval) {
                        clearInterval(this.broadcastInterval);
                        this.broadcastInterval = null;
                    }
                    
                    this.currentPage = 'pairingResult';
                    this.updatePairingResultDisplay();
                    
                    // 设置3秒倒计时返回门窗信息页面
                    this.pairingSuccessTimer = setTimeout(() => {
                        // 重置标志
                        this.isAddingSameControlDevice = false;
                        this.isRePairing = false;
                        this.rePairingDeviceIndex = -1;
                        this.isFromDeviceInfo = false;
                        
                        // 返回门窗信息页面
                        this.currentPage = 'doorWindowInfo';
                        this.updateDoorWindowInfoDisplay();
                    }, 3000);
                },
                
                // 更新配对结果确认页面显示
                updatePairingResultDisplay: function() {
                    // 对号SVG图标，大小调整为32px
                    const checkmarkIcon = `<svg t="1764726342827" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5535" width="32" height="32"><path d="M511.6 883.2c-205.2 0-372.1-166.7-372.1-371.5 0-204.9 166.9-371.5 372.1-371.5 205.2 0 372.1 166.7 372.1 371.5 0 204.9-166.9 371.5-372.1 371.5m0-817.3C265.3 65.9 65 265.9 65 511.7s200.3 445.8 446.6 445.8c246.2 0 446.6-200 446.6-445.8-0.1-245.8-200.4-445.8-446.6-445.8" p-id="5536"></path><path d="M636.1 415.4L459.6 608l-72.2-80.8c-13.7-15.3-37.2-16.6-52.5-3-15.3 13.7-16.7 37.2-3 52.5l99.7 111.5c7 7.8 17 12.3 27.5 12.4h0.2c10.4 0 20.4-4.4 27.5-12.1L691 465.6c13.9-15.1 12.8-38.6-2.3-52.5-15.2-13.8-38.7-12.8-52.6 2.3" p-id="5537"></path></svg>`;
                    
                    let content = `
                        <div class="settings-content">
                            <!-- 第1行：空行 -->
                            <div style="height: 24px;"></div>
                            <!-- 第2-3行：图标（2行高度，32px，上下左右居中） -->
                            <div style="height: 48px; width: 100%; display: flex; justify-content: center; align-items: center;">
                                ${checkmarkIcon}
                            </div>
                            <!-- 第4行：配对成功（1行高度，字体16px，上下左右居中） -->
                            <div style="height: 24px; width: 100%; display: flex; justify-content: center; align-items: center; font-size: 16px; text-align: center;">
                                配对成功
                            </div>
                        </div>
                    `;
                    
                    // 更新屏幕动态区域内容
                    screenContent.innerHTML = content;
                },
                
                // 更新添加更多设备页面显示
                updateContinuePairingDisplay: function() {
                    // 对号SVG图标，大小调整为32px
                    const checkmarkIcon = `<svg t="1764726342827" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5535" width="32" height="32"><path d="M511.6 883.2c-205.2 0-372.1-166.7-372.1-371.5 0-204.9 166.9-371.5 372.1-371.5 205.2 0 372.1 166.7 372.1 371.5 0 204.9-166.9 371.5-372.1 371.5m0-817.3C265.3 65.9 65 265.9 65 511.7s200.3 445.8 446.6 445.8c246.2 0 446.6-200 446.6-445.8-0.1-245.8-200.4-445.8-446.6-445.8" p-id="5536"></path><path d="M636.1 415.4L459.6 608l-72.2-80.8c-13.7-15.3-37.2-16.6-52.5-3-15.3 13.7-16.7 37.2-3 52.5l99.7 111.5c7 7.8 17 12.3 27.5 12.4h0.2c10.4 0 20.4-4.4 27.5-12.1L691 465.6c13.9-15.1 12.8-38.6-2.3-52.5-15.2-13.8-38.7-12.8-52.6 2.3" p-id="5537"></path></svg>`;
                    
                    let content = `
                        <div class="settings-content">
                            <!-- 第1行：空行 -->
                            <div style="height: 24px;"></div>
                            <!-- 第2行：配对成功（1行高度，字体16px，上下左右居中） -->
                            <div style="height: 24px; width: 100%; display: flex; justify-content: center; align-items: center; font-size: 16px; text-align: center;">
                                配对成功
                            </div>
                            <!-- 第3-4行：图标（2行高度，32px，上下左右居中） -->
                            <div style="height: 48px; width: 100%; display: flex; justify-content: center; align-items: center;">
                                ${checkmarkIcon}
                            </div>
                            <!-- 第5行：返回 -->
                            <div class="settings-item ${this.continuePairingIndex === 1 ? 'selected' : ''}" style="height: 24px; line-height: 24px; font-size: 16px; text-align: center; width: 100%; display: flex; justify-content: center; align-items: center;">
                                返回
                            </div>
                            <!-- 第6行：添加同步控制的门窗 -->
                            <div class="settings-item ${this.continuePairingIndex === 0 ? 'selected' : ''}" style="height: 24px; line-height: 24px; font-size: 16px; text-align: center; width: 100%; display: flex; justify-content: center; align-items: center;">
                                添加同步控制的门窗
                            </div>
                        </div>
                    `;
                    
                    // 更新屏幕动态区域内容
                    screenContent.innerHTML = content;
                },
                
                // 更新配对超时页面显示
                updatePairingTimeoutDisplay: function() {
                    // 检查当前是否是从门窗列表的重新配对或添加同控门窗进入的超时页面
                    const isFromDeviceInfo = this.isFromDeviceInfo || this.isRePairing || this.isAddingSameControlDevice;
                    
                    let content = `
                        <div class="settings-content">
                            <div class="settings-header" style="justify-content: center;">
                                <span class="settings-icon"></span>
                                <span class="settings-title"></span>
                            </div>
                            <div style="flex: 1; display: flex; flex-direction: column; width: 100%;">
                                <!-- 第2-4行合并，居中显示 -->
                                <div style="height: 72px; display: flex; justify-content: center; align-items: center; font-size: 16px; text-align: center;">
                                    超时未确认配对结果
                                </div>
                    `;
                    
                    // 如果不是从设备信息页面进入的配对，则显示重新配对选项
                    if (!isFromDeviceInfo) {
                        content += `
                                <!-- 第5行：重新配对 -->
                                <div class="settings-item ${this.continuePairingIndex === 0 ? 'selected' : ''}" style="height: 24px; line-height: 24px; font-size: 16px; text-align: center; width: 100%; display: flex; justify-content: center; align-items: center;">
                                    重新配对
                                </div>
                        `;
                    }
                    
                    content += `
                                <!-- 第5/6行：取消 -->
                                <div class="settings-item ${isFromDeviceInfo || this.continuePairingIndex === 1 ? 'selected' : ''}" style="height: 24px; line-height: 24px; font-size: 16px; text-align: center; width: 100%; display: flex; justify-content: center; align-items: center;">
                                    取消
                                </div>
                            </div>
                        </div>
                    `;
                    
                    // 更新屏幕动态区域内容
                    screenContent.innerHTML = content;
                },
                
                // 处理继续配对页面的选项切换
                prevContinuePairingOption: function() {
                    // 检查当前是否是从门窗列表的重新配对或添加同控门窗进入的超时页面
                    const isFromDeviceInfo = this.isFromDeviceInfo || this.isRePairing || this.isAddingSameControlDevice;
                    
                    // 如果是从设备信息页面进入的，不允许切换选项，始终保持在取消选项
                    if (this.currentPage === 'pairingTimeout' && isFromDeviceInfo) {
                        return;
                    }
                    
                    if (this.continuePairingIndex > 0) {
                        this.continuePairingIndex--;
                    } else {
                        this.continuePairingIndex = 1;
                    }
                    if (this.currentPage === 'continuePairing') {
                        this.updateContinuePairingDisplay();
                    } else if (this.currentPage === 'pairingTimeout') {
                        this.updatePairingTimeoutDisplay();
                    }
                },
                
                nextContinuePairingOption: function() {
                    // 检查当前是否是从门窗列表的重新配对或添加同控门窗进入的超时页面
                    const isFromDeviceInfo = this.isFromDeviceInfo || this.isRePairing || this.isAddingSameControlDevice;
                    
                    // 如果是从设备信息页面进入的，不允许切换选项，始终保持在取消选项
                    if (this.currentPage === 'pairingTimeout' && isFromDeviceInfo) {
                        return;
                    }
                    
                    if (this.continuePairingIndex < 1) {
                        this.continuePairingIndex++;
                    } else {
                        this.continuePairingIndex = 0;
                    }
                    if (this.currentPage === 'continuePairing') {
                        this.updateContinuePairingDisplay();
                    } else if (this.currentPage === 'pairingTimeout') {
                        this.updatePairingTimeoutDisplay();
                    }
                },
                
                // 处理继续配对页面的OK键
                selectContinuePairingOption: function() {
                    // 检查当前是否是从门窗列表的重新配对或添加同控门窗进入的超时页面
                    const isFromDeviceInfo = this.isFromDeviceInfo || this.isRePairing || this.isAddingSameControlDevice;
                    
                    if (this.currentPage === 'continuePairing') {
                        if (this.continuePairingIndex === 0) {
                            // 选择"添加同控门窗"，进入蓝牙配对页面
                            this.isAddingSameControlDevice = true;
                            this.isFromDeviceInfo = false; // 从初始添加流程进入的同控设备添加
                            this.currentPage = 'bluetoothPairing';
                            this.updateBluetoothPairingDisplay();
                        } else {
                            // 选择"取消"，返回待机页面
                            this.currentPage = 'standby';
                            this.updateStandbyDisplay();
                        }
                    } else if (this.currentPage === 'pairingTimeout') {
                        if (isFromDeviceInfo) {
                            // 如果是从设备信息页面进入的超时页面，无论选择什么都返回设备信息页面
                            // 重置相关标志
                            this.isAddingSameControlDevice = false;
                            this.isRePairing = false;
                            this.isFromDeviceInfo = false;
                            // 返回设备信息页面
                            this.currentPage = 'doorWindowInfo';
                            this.updateDoorWindowInfoDisplay();
                        } else if (this.continuePairingIndex === 0) {
                            // 普通配对超时，选择"重新配对"，进入蓝牙配对页面
                            this.isAddingSameControlDevice = false;
                            this.isRePairing = false;
                            this.currentPage = 'bluetoothPairing';
                            this.updateBluetoothPairingDisplay();
                        } else {
                            // 普通配对超时，选择"取消"，返回待机页面
                            this.currentPage = 'standby';
                            this.updateStandbyDisplay();
                        }
                    }
                },
                
                // 切换到下一个设备
                nextDevice: function() {
                    if (this.devices.length > 0) {
                        this.currentDeviceIndex = (this.currentDeviceIndex + 1) % this.devices.length;
                        this.updateStandbyDisplay();
                    }
                },
                
                // 切换到上一个设备
                prevDevice: function() {
                    if (this.devices.length > 0) {
                        this.currentDeviceIndex = (this.currentDeviceIndex - 1 + this.devices.length) % this.devices.length;
                        this.updateStandbyDisplay();
                    }
                },
                
                // 更新退出配对确认页面显示
                updateExitPairingConfirmDisplay: function() {
                    let content = `
                        <div class="settings-content">
                            <div class="settings-header" style="justify-content: center;">
                                <span class="settings-icon"></span>
                                <span class="settings-title"></span>
                            </div>
                            <div style="flex: 1; display: flex; flex-direction: column; width: 100%;">
                                <!-- 第2-4行合并，居中显示 -->
                                <div style="height: 72px; display: flex; justify-content: center; align-items: center; font-size: 16px; text-align: center;">
                                    确认退出配对吗？
                                </div>
                                <!-- 第5行：取消 -->
                                <div class="settings-item ${this.exitPairingIndex === 0 ? 'selected' : ''}" style="height: 24px; line-height: 24px; font-size: 16px; text-align: center; width: 100%; display: flex; justify-content: center; align-items: center;">
                                    取消
                                </div>
                                <!-- 第6行：确认 -->
                                <div class="settings-item ${this.exitPairingIndex === 1 ? 'selected' : ''}" style="height: 24px; line-height: 24px; font-size: 16px; text-align: center; width: 100%; display: flex; justify-content: center; align-items: center;">
                                    确认
                                </div>
                            </div>
                        </div>
                    `;
                    
                    // 更新屏幕动态区域内容
                    screenContent.innerHTML = content;
                },
                
                // 处理退出配对确认页面的选项切换
                prevExitPairingOption: function() {
                    if (this.exitPairingIndex > 0) {
                        this.exitPairingIndex--;
                    } else {
                        this.exitPairingIndex = 1;
                    }
                    this.updateExitPairingConfirmDisplay();
                },
                
                nextExitPairingOption: function() {
                    if (this.exitPairingIndex < 1) {
                        this.exitPairingIndex++;
                    } else {
                        this.exitPairingIndex = 0;
                    }
                    this.updateExitPairingConfirmDisplay();
                },
                
                // 处理退出配对确认页面的OK键
                selectExitPairingOption: function() {
                    if (this.exitPairingIndex === 0) {
                        // 选择"取消"，返回蓝牙配对页面，继续倒计时
                        this.currentPage = 'bluetoothPairing';
                        this.updateBluetoothPairingDisplay();
                    } else {
                        // 选择"确认"，返回待机页面，中断倒计时
                        if (this.countdownInterval) {
                            clearInterval(this.countdownInterval);
                            this.countdownInterval = null;
                        }
                        this.currentPage = 'standby';
                        this.updateStandbyDisplay();
                    }
                },
                
                // 更新删除确认页面显示
                updateDeleteConfirmDisplay: function() {
                    let content = `
                        <div class="settings-content">
                            <div class="settings-header">
                                <span class="settings-icon"></span>
                                <span class="settings-title"></span>
                            </div>
                            <div style="flex: 1; display: flex; flex-direction: column; width: 100%;">
                                <!-- 第2行：是否删除配对？ -->
                                <div style="height: 24px; line-height: 24px; font-size: 16px; text-align: center; width: 100%; display: flex; justify-content: center; align-items: center;">
                                    是否删除配对？
                                </div>
                                <!-- 第3-4行：图标 -->
                                <div style="height: 48px; width: 100%; display: flex; justify-content: center; align-items: center; text-align: center;">
                                    <svg t="1764729596966" class="icon" viewBox="0 0 1104 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="7404" width="32" height="32"><path d="M961.369 1020.986H141.063c-55.01 0-99.202-21.701-121.272-59.552-22.076-37.85-19.39-87.293 7.396-135.606l413.89-746.48c26.941-48.666 67.004-76.561 109.866-76.561 42.867 0 82.89 27.86 109.907 76.483l414.323 746.635c26.78 48.314 29.55 97.72 7.433 135.565-22.035 37.85-66.263 59.516-121.237 59.516zM550.984 81.148c-13.628 0-29.239 13.595-41.894 36.362L95.202 864.067c-12.968 23.43-16.004 44.475-8.258 57.752 7.753 13.244 27.488 20.85 54.119 20.85h820.306c26.673 0 46.372-7.565 54.119-20.85 7.704-13.242 4.71-34.28-8.293-57.71l-414.318-746.6c-12.618-22.766-28.306-36.361-41.893-36.361z m0.233 586.348c-21.488 0-38.93-17.516-38.93-39.182v-352.63c0-21.63 17.442-39.183 38.93-39.183 21.492 0 38.934 17.554 38.934 39.183v352.63c0 21.666-17.442 39.182-38.934 39.182z m-0.279 191.523c33.503 0 60.663-27.382 60.663-61.16 0-33.777-27.16-61.159-60.663-61.159s-60.663 27.382-60.663 61.16c0 33.777 27.16 61.16 60.663 61.16z" p-id="7405"></path></svg>
                                </div>
                                <!-- 第5行：取消 -->
                                <div class="settings-item ${this.deleteConfirmIndex === 0 ? 'selected' : ''}" style="height: 24px; line-height: 24px; font-size: 16px; text-align: center; width: 100%; display: flex; justify-content: center; align-items: center;">
                                    取消
                                </div>
                                <!-- 第6行：删除 -->
                                <div class="settings-item ${this.deleteConfirmIndex === 1 ? 'selected' : ''}" style="height: 24px; line-height: 24px; font-size: 16px; text-align: center; width: 100%; display: flex; justify-content: center; align-items: center;">
                                    删除
                                </div>
                            </div>
                        </div>
                    `;
                    
                    // 更新屏幕动态区域内容
                    screenContent.innerHTML = content;
                },
                
                // 选择上一个删除确认选项
                prevDeleteConfirmOption: function() {
                    if (this.deleteConfirmIndex > 0) {
                        this.deleteConfirmIndex--;
                    } else {
                        this.deleteConfirmIndex = 1;
                    }
                    this.updateDeleteConfirmDisplay();
                },
                
                // 选择下一个删除确认选项
                nextDeleteConfirmOption: function() {
                    if (this.deleteConfirmIndex < 1) {
                        this.deleteConfirmIndex++;
                    } else {
                        this.deleteConfirmIndex = 0;
                    }
                    this.updateDeleteConfirmDisplay();
                },
                
                // 处理删除确认页面的OK键
                selectDeleteConfirmOption: function() {
                    if (this.deleteConfirmIndex === 0) {
                        // 选择"取消"，返回门窗信息页面
                        this.currentPage = 'doorWindowInfo';
                        this.updateDoorWindowInfoDisplay();
                    } else {
                        // 选择"删除"，执行删除操作
                        this.removeDevice(this.currentDeviceIndex);
                        // 返回门窗列表页面
                        this.currentPage = 'submenu';
                        this.currentSubMenu = '门窗列表';
                        this.subMenuIndex = 0;
                        this.subMenuPage = 0;
                        this.updateSubMenuDisplay();
                    }
                },
                
                // 更新门窗信息页面显示
                updateDoorWindowInfoDisplay: function() {
                    const currentDevice = this.devices[this.currentDeviceIndex] || '';
                    const infoItems = this.doorWindowInfoItems;
                    
                    // 用户提供的SVG图标，已清理格式
                    const deviceInfoIcon = `<svg t="1764661367369" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="6669" width="16" height="16"><path d="M529.2 820.4c-37.4 0-74.8-9.1-104-27.3L240.5 677.7c-10.3-6.4-13.4-20-7-30.3s20-13.4 30.3-7l184.7 115.4c43.7 27.3 117.6 27.3 161.3 0l184.7-115.4c10.3-6.4 23.9-3.3 30.3 7 6.4 10.3 3.3 23.9-7 30.3L633.2 793.1c-29.2 18.2-66.6 27.3-104 27.3z" fill="#040000" p-id="6670"></path><path d="M529.2 662.8c-37.4 0-74.8-9.1-104-27.3L240.5 520.1c-31.3-19.6-48.6-46.7-48.6-76.4s17.3-56.8 48.6-76.4l184.7-115.4c58.3-36.4 149.7-36.5 208 0l184.7 115.4c31.3 19.6 48.6 46.7 48.6 76.4s-17.3 56.8-48.6 76.4L633.2 635.5c-29.2 18.2-66.6 27.3-104 27.3z m0-394.1c-29.4 0-58.8 6.8-80.7 20.5L263.9 404.7c-18 11.2-27.9 25.1-27.9 39s9.9 27.8 27.9 39l184.7 115.4c43.7 27.3 117.6 27.3 161.3 0l184.7-115.4c18-11.2 27.9-25.1 27.9-39s-9.9-27.8-27.9-39L609.9 289.3c-21.9-13.7-51.3-20.6-80.7-20.6z" fill="#040000" p-id="6671"></path></svg>`;
                    
                    let content = `
                        <div class="settings-content">
                            <div class="settings-header">
                                <span class="settings-icon">
                                    ${deviceInfoIcon}
                                </span>
                                <span class="settings-title">${currentDevice}</span>
                            </div>
                            <div class="settings-list">
                    `;
                    
                    // 生成门窗信息选项列表
                    infoItems.forEach((item, index) => {
                        const isSelected = index === this.doorWindowInfoIndex;
                        // 为特定选项添加右侧箭头
                        const hasArrow = ['重新配对', '添加同控门窗', '删除配对'].includes(item);
                        content += `
                            <div class="settings-item ${isSelected ? 'selected' : ''}" data-index="${index}">
                                <span>${item}</span>
                                ${hasArrow ? '<span class="settings-item-arrow">›</span>' : ''}
                            </div>
                        `;
                    });
                    
                    content += `
                            </div>
                        </div>
                    `;
                    
                    // 更新屏幕动态区域内容
                    screenContent.innerHTML = content;
                },
                
                // 更新童锁提示页面显示（操作受限提示）
                updateChildLockTipDisplay: function() {
                    // 获取当前选择的设备名称
                    const currentDeviceName = this.devices.length > 0 ? this.devices[this.currentDeviceIndex] : '设备';
                    
                    let content = `
                        <div style="width: 100%; height: 144px; display: flex; flex-direction: column; justify-content: flex-start; align-items: flex-start;">
                            <!-- 第1行：设备名称 -->
                            <div style="height: 24px; width: 100%; display: flex; justify-content: center; align-items: center;">
                                <span style="text-align: center; font-size: 16px;">${currentDeviceName}</span>
                            </div>
                            <!-- 第2行：空行 -->
                            <div style="height: 24px; width: 100%;"></div>
                            <!-- 第3行：显示指定icon -->
                            <div style="height: 24px; width: 100%; display: flex; justify-content: center; align-items: center;">
                                <svg t="1764669560221" class="icon" viewBox="0 0 1090 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="25297" width="32" height="32" style="display: block;"><path d="M290.023226 578.064516a24.774194 24.774194 0 0 0-18.498065 29.729032 280.774194 280.774194 0 0 0 547.014194 0 24.774194 24.774194 0 0 0-48.227097-11.230967 231.225806 231.225806 0 0 1-450.56 0 24.774194 24.774194 0 0 0-29.729032-18.498065zM576.743226 208.59871a24.774194 24.774194 0 0 0-33.032258 36.500645c28.903226 26.590968 79.277419 39.63871 123.045161 39.63871a174.905806 174.905806 0 0 0 41.125161-3.963871C786.498065 260.459355 891.870968 130.642581 891.870968 24.774194a24.774194 24.774194 0 0 0-49.548387 0c0 86.379355-92.655484 193.734194-146.332904 206.451612-37.987097 10.24-95.95871-1.156129-119.246451-22.627096z" fill="#2c2c2c" p-id="25298"></path><path d="M1090.064516 611.096774a131.138065 131.138065 0 0 0-69.037419-115.612903 472.196129 472.196129 0 0 0-118.750968-269.378065 24.774194 24.774194 0 0 0-36.996129 33.032259 423.63871 423.63871 0 0 1 107.850323 254.348387 24.774194 24.774194 0 0 0 2.147096 8.092903v0.990968a24.609032 24.609032 0 0 0 4.789678 6.606451 24.609032 24.609032 0 0 0 7.101935 4.459355A82.580645 82.580645 0 0 1 963.550968 693.677419h-8.588387l-2.47742 1.321291-1.816774 1.156129-1.981935 1.651613-1.651613 1.486451-1.651613 1.981936-1.321291 1.816774-1.32129 2.477419v1.321291A429.419355 429.419355 0 0 1 148.645161 708.707097v-1.321291l-1.32129-2.312258-1.486452-1.981935-1.486451-1.816774-1.816774-1.651613-1.816775-1.486452-1.981935-1.32129-2.147097-1.156129-2.147097-0.825807h-6.606451a82.580645 82.580645 0 0 1-53.016774-140.552258 84.562581 84.562581 0 0 1 27.912258-18.332903 24.609032 24.609032 0 0 0 7.101935-4.459355 24.609032 24.609032 0 0 0 4.789677-6.606451v-0.990968a24.774194 24.774194 0 0 0 2.147097-8.092903A429.419355 429.419355 0 0 1 491.850323 119.08129 401.672258 401.672258 0 0 1 545.032258 115.612903a423.143226 423.143226 0 0 1 152.609032 28.07742 24.774194 24.774194 0 0 0 17.83742-46.245162A472.526452 472.526452 0 0 0 545.032258 66.064516a450.064516 450.064516 0 0 0-59.458064 3.79871A478.967742 478.967742 0 0 0 69.202581 495.483871a135.101935 135.101935 0 0 0-30.554839 22.627097 132.129032 132.129032 0 0 0 69.532903 222.80258 478.967742 478.967742 0 0 0 873.703226 0A132.129032 132.129032 0 0 0 1090.064516 611.096774z" fill="#2c2c2c" p-id="25299"></path><path d="M371.612903 454.193548m-66.064516 0a66.064516 66.064516 0 1 0 132.129032 0 66.064516 66.064516 0 1 0-132.129032 0Z" fill="#2c2c2c" p-id="25300"></path><path d="M743.225806 462.451613m-66.064516 0a66.064516 66.064516 0 1 0 132.129033 0 66.064516 66.064516 0 1 0-132.129033 0Z" fill="#2c2c2c" p-id="25301"></path></svg>
                            </div>
                            <!-- 第4行：空行 -->
                            <div style="height: 24px; width: 100%;"></div>
                            <!-- 第5-6行合并：提示文字，字体16px -->
                            <div style="height: 48px; width: 100%; display: flex; justify-content: center; align-items: center;">
                                <span style="text-align: center; font-size: 16px;">请在设置中关闭童锁</span>
                            </div>
                        </div>
                    `;
                    
                    // 更新屏幕动态区域内容
                    screenContent.innerHTML = content;
                    
                    // 3秒后自动返回待机页面
                    if (this.childLockTipTimer) {
                        clearTimeout(this.childLockTipTimer);
                    }
                    this.childLockTipTimer = setTimeout(() => {
                        this.currentPage = 'standby';
                        this.updateStandbyDisplay();
                    }, 3000);
                },
                
                // 更新童锁已关闭提示页面显示，倒计时3秒返回待机
                updateChildLockClosedDisplay: function() {
                    let content = `
                        <div style="width: 100%; height: 144px; display: flex; flex-direction: column; justify-content: flex-start; align-items: flex-start;">
                            <!-- 第1行：空行 -->
                            <div style="height: 24px; width: 100%;"></div>
                            <!-- 第2-4行合并：显示icon -->
                            <div style="height: 72px; width: 100%; display: flex; justify-content: center; align-items: center;">
                                <svg t="1764668323805" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="23214" width="48" height="48"><path d="M768.25422 0q48.810328 0 94.061569 18.303873t80.333664 50.33565 56.436941 74.740814 21.354518 91.519364l0 150.49851-123.042701 0 0-122.025819q0-64.063555-36.099305-99.654419t-97.112214-35.590864q-54.911619 0-88.468719 35.590864t-33.5571 99.654419l0 124.059583-128.12711 0 0-152.532274q0-48.810328 19.320755-91.519364t53.386296-74.740814 80.333664-50.33565 101.179742-18.303873zM766.220457 693.513406l0 87.451837 0 47.793446q0 27.455809-9.660377 51.860973t-26.438928 41.692155-39.658391 27.455809-50.33565 10.168818l-514.542205 0q-27.455809 0-49.82721-9.660377t-38.641509-26.438928-24.913605-39.14995-8.643496-47.793446l0-323.368421q0-28.472691 19.829196-47.793446t46.268123-19.320755l629.449851 0q28.472691 0 47.793446 19.320755t19.320755 47.793446l0 179.988083z" fill="#262626" p-id="23215"></path></svg>
                            </div>
                            <!-- 第5-6行合并：童锁关闭，字体16px -->
                            <div style="height: 48px; width: 100%; display: flex; justify-content: center; align-items: center;">
                                <span style="text-align: center; font-size: 16px;">童锁关闭</span>
                            </div>
                        </div>
                    `;
                    
                    // 更新屏幕动态区域内容
                    screenContent.innerHTML = content;
                    
                    // 启动3秒倒计时
                    this.startChildLockCountdown();
                },
                
                // 更新童锁已开启提示页面显示，倒计时3秒返回待机
                updateChildLockOpenedDisplay: function() {
                    let content = `
                        <div style="width: 100%; height: 144px; display: flex; flex-direction: column; justify-content: flex-start; align-items: flex-start;">
                            <!-- 第1行：空行 -->
                            <div style="height: 24px; width: 100%;"></div>
                            <!-- 第2-4行合并：显示icon -->
                            <div style="height: 72px; width: 100%; display: flex; justify-content: center; align-items: center;">
                                <svg t="1764668313299" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="23047" width="48" height="48"><path d="M385.150849 385.662338l-128.895105 0 0-150.377622q0-49.102897 19.436563-91.556444t53.706294-74.677323 80.815185-50.637363 101.786214-18.413586q49.102897 0 94.625375 18.413586t80.815185 50.637363 56.263736 74.677323 20.971029 91.556444l0 150.377622-123.78022 0 0-121.734266q0-64.447552-35.804196-99.74026t-97.182817-35.292707q-55.240759 0-88.999001 35.292707t-33.758242 99.74026l0 121.734266zM826.053946 447.040959q27.62038 0 47.568432 19.948052t19.948052 47.568432l0 317.122877q0 27.62038-9.718282 51.66034t-26.597403 41.942058-39.896104 28.131868-50.637363 10.22977l-516.603397 0q-27.62038 0-50.125874-10.22977t-38.361638-27.108891-24.551449-39.384615-8.695305-48.07992l0-324.283716q0-27.62038 19.436563-47.568432t47.056943-19.948052l61.378621 0 128.895105 0 255.744256 0 123.78022 0 61.378621 0z" fill="#262626" p-id="23048"></path></svg>
                            </div>
                            <!-- 第5-6行合并：童锁开启，字体16px -->
                            <div style="height: 48px; width: 100%; display: flex; justify-content: center; align-items: center;">
                                <span style="text-align: center; font-size: 16px;">童锁开启</span>
                            </div>
                        </div>
                    `;
                    
                    // 更新屏幕动态区域内容
                    screenContent.innerHTML = content;
                    
                    // 启动3秒倒计时
                    this.startChildLockCountdown();
                },
                
                // 童锁状态切换后启动3秒倒计时返回待机
                startChildLockCountdown: function() {
                    // 清除之前的倒计时
                    if (this.childLockCountdownTimer) {
                        clearTimeout(this.childLockCountdownTimer);
                    }
                    
                    // 清除之前的interval
                    if (this.childLockCountdownInterval) {
                        clearInterval(this.childLockCountdownInterval);
                    }
                    
                    let countdown = 3;
                    
                    // 更新倒计时显示（仅显示数字）
                    const updateCountdown = () => {
                        const countdownElement = document.querySelector('.countdown-display');
                        if (countdownElement) {
                            countdownElement.textContent = `${countdown}`;
                        }
                    };
                    
                    // 每秒更新一次倒计时
                    this.childLockCountdownInterval = setInterval(() => {
                        countdown--;
                        updateCountdown();
                        
                        if (countdown <= 0) {
                            clearInterval(this.childLockCountdownInterval);
                            // 倒计时结束，返回待机页面
                            this.currentPage = 'standby';
                            this.updateStandbyDisplay();
                        }
                    }, 1000);
                    
                    // 保存倒计时引用
                    this.childLockCountdownTimer = this.childLockCountdownInterval;
                },
                
                // 更新自动关门感应启用提醒页面显示
                updateAutoCloseEnabledDisplay: function() {
                    let content = `
                        <div style="width: 100%; height: 144px; display: flex; flex-direction: column; justify-content: flex-start; align-items: flex-start;">
                            <!-- 第1行：空行 -->
                            <div style="height: 24px; width: 100%;"></div>
                            <!-- 第2-4行合并：显示指定icon -->
                            <div style="height: 72px; width: 100%; display: flex; justify-content: center; align-items: center;">
                                <svg t="1764672123986" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="48946" width="48" height="48"><path d="M270.336 723.968c-10.752 0-21.504-4.608-28.672-13.824-44.544-56.832-68.096-125.44-68.096-197.632 0-74.752 26.112-146.944 73.728-204.288 12.8-15.36 35.84-17.408 51.2-4.608s17.408 35.84 4.608 51.2c-36.864 44.032-56.832 100.352-56.832 158.208 0 55.808 18.432 109.056 52.736 153.088 12.288 15.872 9.728 38.4-6.144 50.688-6.656 4.608-14.336 7.168-22.528 7.168zM753.664 723.968c-7.68 0-15.872-2.56-22.528-7.68-15.872-12.288-18.432-35.328-6.144-50.688 34.304-44.032 52.736-96.768 52.736-153.088 0-57.856-20.48-113.664-56.832-158.208-12.8-15.36-10.752-38.4 4.608-51.2s38.4-10.752 51.2 4.608c47.616 57.344 73.728 130.048 73.728 204.288 0 72.192-23.552 140.8-68.096 197.632-7.168 9.728-17.92 14.336-28.672 14.336z" fill="#040000" p-id="48947"></path><path d="M873.984 850.944c-8.704 0-16.896-3.072-24.064-9.216-14.848-13.312-16.384-36.352-3.072-51.2a420.864 420.864 0 0 0 104.96-278.016c0-105.472-38.912-205.824-109.568-283.648-13.312-14.848-12.288-37.888 2.56-51.2 14.848-13.312 37.888-12.288 51.2 2.56 82.432 90.624 128 208.896 128 332.288 0 120.32-43.52 236.032-122.88 326.144a36.3008 36.3008 0 0 1-27.136 12.288zM150.016 850.944c-10.24 0-19.968-4.096-27.136-12.288-79.36-90.112-122.88-205.824-122.88-326.144 0-123.392 45.568-241.664 128.512-332.8 13.312-14.848 36.352-15.872 51.2-2.56 14.848 13.312 15.872 36.352 2.56 51.2A421.39648 421.39648 0 0 0 72.704 512c0 102.4 37.376 201.216 104.96 278.016 13.312 14.848 11.776 37.888-3.072 51.2-7.168 6.656-15.872 9.728-24.576 9.728zM566.272 675.328H451.584c-59.904 0-108.544-48.64-108.544-108.544V452.096c0-59.904 48.64-108.544 108.544-108.544h114.688c59.904 0 108.544 48.64 108.544 108.544v114.688c0.512 59.904-48.64 108.544-108.544 108.544zM451.584 415.744c-19.968 0-36.352 16.384-36.352 36.352v114.688c0 19.968 16.384 36.352 36.352 36.352h114.688c19.968 0 36.352-16.384 36.352-36.352V452.096c0-19.968-16.384-36.352-36.352-36.352H451.584z" fill="#040000" p-id="48948"></path></svg>
                            </div>
                            <!-- 第5-6行合并：提示文字，字体16px -->
                            <div style="height: 48px; width: 100%; display: flex; justify-content: center; align-items: center;">
                                <span style="text-align: center; font-size: 16px;">自动关门感应开启</span>
                            </div>
                        </div>
                    `;
                    
                    // 更新屏幕动态区域内容
                    screenContent.innerHTML = content;
                    
                    // 3秒后自动返回待机页面
                    if (this.autoCloseTimer) {
                        clearTimeout(this.autoCloseTimer);
                    }
                    this.autoCloseTimer = setTimeout(() => {
                        this.currentPage = 'standby';
                        this.updateStandbyDisplay();
                    }, 3000);
                },
                
                // 更新自动关门感应关闭提醒页面显示
                updateAutoCloseDisabledDisplay: function() {
                    let content = `
                        <div style="width: 100%; height: 144px; display: flex; flex-direction: column; justify-content: flex-start; align-items: flex-start;">
                            <!-- 第1行：空行 -->
                            <div style="height: 24px; width: 100%;"></div>
                            <!-- 第2-4行合并：显示指定icon -->
                            <div style="height: 72px; width: 100%; display: flex; justify-content: center; align-items: center;">
                                <svg t="1764672236717" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="50788" width="48" height="48"><path d="M512 85.333333c235.648 0 426.666667 191.018667 426.666667 426.666667s-191.018667 426.666667-426.666667 426.666667S85.333333 747.648 85.333333 512 276.352 85.333333 512 85.333333zM170.666667 512a341.333333 341.333333 0 0 0 550.016 270.08L241.92 303.36A339.84 339.84 0 0 0 170.666667 512z m341.333333-341.333333a339.882667 339.882667 0 0 0-209.877333 72.106666L781.226667 721.92A341.333333 341.333333 0 0 0 512 170.666667z" fill="#000000" p-id="50789"></path></svg>
                            </div>
                            <!-- 第5-6行合并：提示文字，字体16px -->
                            <div style="height: 48px; width: 100%; display: flex; justify-content: center; align-items: center;">
                                <span style="text-align: center; font-size: 16px;">自动关门感应关闭</span>
                            </div>
                        </div>
                    `;
                    
                    // 更新屏幕动态区域内容
                    screenContent.innerHTML = content;
                    
                    // 3秒后自动返回待机页面
                    if (this.autoCloseTimer) {
                        clearTimeout(this.autoCloseTimer);
                    }
                    this.autoCloseTimer = setTimeout(() => {
                        this.currentPage = 'standby';
                        this.updateStandbyDisplay();
                    }, 3000);
                },
                
                // 更新自动关门感应使用说明页面显示
                updateAutoCloseManualDisplay: function() {
                    // 虚拟二维码SVG
                    const virtualQRCode = `<svg width="80" height="80" xmlns="http://www.w3.org/2000/svg">
                        <rect width="80" height="80" fill="white" stroke="#ccc" stroke-width="1"/>
                        <rect x="10" y="10" width="20" height="20" fill="black"/>
                        <rect x="50" y="10" width="20" height="20" fill="black"/>
                        <rect x="10" y="50" width="20" height="20" fill="black"/>
                        <rect x="50" y="50" width="20" height="20" fill="black"/>
                        <rect x="30" y="30" width="20" height="20" fill="black"/>
                        <rect x="20" y="20" width="10" height="10" fill="black"/>
                        <rect x="50" y="20" width="10" height="10" fill="black"/>
                        <rect x="20" y="50" width="10" height="10" fill="black"/>
                        <rect x="50" y="50" width="10" height="10" fill="black"/>
                        <rect x="30" y="10" width="10" height="10" fill="black"/>
                        <rect x="30" y="60" width="10" height="10" fill="black"/>
                        <rect x="10" y="30" width="10" height="10" fill="black"/>
                        <rect x="60" y="30" width="10" height="10" fill="black"/>
                    </svg>`;
                    
                    let content = `
                        <div class="settings-content">
                            <!-- 第1行：空行 -->
                            <div style="height: 24px; width: 100%;"></div>
                            <!-- 第2-5行合并：二维码 -->
                            <div style="height: 96px; width: 100%; display: flex; justify-content: center; align-items: center;">
                                ${virtualQRCode}
                            </div>
                            <!-- 第6行：扫码查看说明，字体16px -->
                            <div style="height: 24px; width: 100%; display: flex; justify-content: center; align-items: center;">
                                <span style="text-align: center; font-size: 16px;">扫码查看说明</span>
                            </div>
                        </div>
                    `;
                    
                    // 更新屏幕动态区域内容
                    screenContent.innerHTML = content;
                },
                
                // 选择上一个门窗信息选项
                prevDoorWindowInfoItem: function() {
                    if (this.doorWindowInfoIndex === 0) {
                        // 已经是第一个选项，循环到最后一个
                        this.doorWindowInfoIndex = this.doorWindowInfoItems.length - 1;
                    } else {
                        this.doorWindowInfoIndex--;
                    }
                    this.updateDoorWindowInfoDisplay();
                },
                
                // 选择下一个门窗信息选项
                nextDoorWindowInfoItem: function() {
                    if (this.doorWindowInfoIndex === this.doorWindowInfoItems.length - 1) {
                        // 已经是最后一个选项，循环到第一个
                        this.doorWindowInfoIndex = 0;
                    } else {
                        this.doorWindowInfoIndex++;
                    }
                    this.updateDoorWindowInfoDisplay();
                },
                
                // 确认选择当前门窗信息选项
                selectDoorWindowInfoItem: function() {
                    const selectedItem = this.doorWindowInfoItems[this.doorWindowInfoIndex];
                    console.log('选择门窗信息选项:', selectedItem);
                    
                    switch (selectedItem) {
                        case '重新配对':
                            // 保存当前设备类型和索引，设置重新配对标志
                            this.currentDoorWindowType = this.devices[this.currentDeviceIndex];
                            this.isAddingSameControlDevice = false;
                            this.isRePairing = true;
                            this.rePairingDeviceIndex = this.currentDeviceIndex;
                            this.currentPage = 'bluetoothPairing';
                            this.updateBluetoothPairingDisplay();
                            break;
                        case '添加同控门窗':
                            // 保存当前设备类型，标记为添加同控门窗
                            this.currentDoorWindowType = this.devices[this.currentDeviceIndex];
                            this.isAddingSameControlDevice = true;
                            this.isFromDeviceInfo = true;
                            this.currentPage = 'bluetoothPairing';
                            this.updateBluetoothPairingDisplay();
                            break;
                        case '删除配对':
                            // 进入删除确认页面
                            this.currentPage = 'deleteConfirm';
                            this.deleteConfirmIndex = 0; // 默认选中取消选项
                            this.updateDeleteConfirmDisplay();
                            break;
                        case '返回':
                            // 返回门窗列表页面
                            this.currentPage = 'submenu';
                            this.currentSubMenu = '门窗列表';
                            this.subMenuIndex = 0;
                            this.subMenuPage = 0;
                            this.updateSubMenuDisplay();
                            break;
                    }
                },
                
                // 更新显示模式页面显示
                updateDisplayModeDisplay: function() {
                    let content = `
                        <div class="settings-content">
                            <!-- 第1行：页面标题和icon -->
                            <div style="height: 24px; width: 100%; display: flex; justify-content: flex-start; align-items: center;">
                                <svg t="1764675007167" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="54961" width="16" height="16" style="margin-right: 5px;"><path d="M957.2 155.8H66.8C30 155.8 0 185.8 0 222.6v578.8c0 36.8 30 66.8 66.8 66.8h890.4c36.8 0 66.8-30 66.8-66.8V222.6c0-36.8-30-66.8-66.8-66.8z m22.3 645.6c0 12.3-10 22.3-22.3 22.3H66.8c-12.3 0-22.3-10-22.3-22.3V222.6c0-12.3 10-22.3 22.3-22.3h890.4c12.3 0 22.3 10 22.3 22.3v578.8z" fill="#000" p-id="54962"></path><path d="M311.7 244.9H133.6c-24.6 0-44.5 20-44.5 44.5V423c0 12.3 10 22.3 22.3 22.3s22.3-10 22.3-22.3V289.4h178.1c12.3 0 22.3-10 22.3-22.3-0.2-12.3-10.2-22.2-22.4-22.2zM912.7 578.8c-12.3 0-22.3 10-22.3 22.3v133.6H712.3c-12.3 0-22.3 10-22.3 22.3s10 22.3 22.3 22.3h178.1c24.5 0 44.5-20 44.5-44.5V601c0.1-12.3-9.9-22.2-22.2-22.2z" fill="#000" p-id="54963"></path></svg>
                                <span style="text-align: left; font-size: 12px;">显示模式</span>
                            </div>
                            <!-- 第3行：流畅，16px，默认选中 -->
                            <div class="settings-item ${this.displayModeIndex === 0 ? 'selected' : ''}" style="height: 24px; line-height: 24px; font-size: 16px; text-align: center; width: 100%; display: flex; justify-content: center; align-items: center;">
                                流畅
                            </div>
                            <!-- 第4行：清晰，16px -->
                            <div class="settings-item ${this.displayModeIndex === 1 ? 'selected' : ''}" style="height: 24px; line-height: 24px; font-size: 16px; text-align: center; width: 100%; display: flex; justify-content: center; align-items: center;">
                                清晰
                            </div>
                            <!-- 第5行：返回，16px -->
                            <div class="settings-item ${this.displayModeIndex === 2 ? 'selected' : ''}" style="height: 24px; line-height: 24px; font-size: 16px; text-align: center; width: 100%; display: flex; justify-content: center; align-items: center;">
                                返回
                            </div>
                        </div>
                    `;
                    
                    // 更新屏幕动态区域内容
                    screenContent.innerHTML = content;
                },
                
                // 更新语言设置页面显示
                updateLanguageDisplay: function() {
                    let content = `
                        <div class="settings-content">
                            <!-- 第1行：页面标题和icon -->
                            <div style="height: 24px; width: 100%; display: flex; justify-content: flex-start; align-items: center;">
                                <svg t="1764677221474" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="62329" width="16" height="16" style="margin-right: 5px;"><path d="M471.04 436.224l-56.832 154.624h115.2l-56.32-154.624H471.04z m219.648-164.352H252.928c-32.768 0-59.904 26.624-59.904 59.904v439.296c0 33.28 26.624 59.904 59.904 59.904h437.76c32.768 0 59.904-26.624 59.904-59.904V331.776c0-33.28-26.624-59.904-59.904-59.904z m-113.664 450.56l-31.744-88.064H398.336l-32.256 88.064H310.784l131.584-342.016H501.76l131.584 342.016h-56.32z m229.376-529.408H315.904c-13.312 0-24.576 11.264-24.576 24.576 0 13.312 11.264 24.576 24.576 24.576h465.92v467.968c0 13.312 11.264 24.576 24.576 24.576 13.312 0 24.576-11.264 24.576-24.576V217.6c0-13.312-11.264-24.576-24.576-24.576z" fill="#070102" p-id="62330"></path></svg>
                                <span style="text-align: left; font-size: 12px;">语言</span>
                            </div>
                            <!-- 第3行：中文，16px，默认选中 -->
                            <div class="settings-item ${this.languageIndex === 0 ? 'selected' : ''}" style="height: 24px; line-height: 24px; font-size: 16px; text-align: center; width: 100%; display: flex; justify-content: center; align-items: center;">
                                中文
                            </div>
                            <!-- 第4行：English，16px -->
                            <div class="settings-item ${this.languageIndex === 1 ? 'selected' : ''}" style="height: 24px; line-height: 24px; font-size: 16px; text-align: center; width: 100%; display: flex; justify-content: center; align-items: center;">
                                English
                            </div>
                            <!-- 第5行：返回，16px -->
                            <div class="settings-item ${this.languageIndex === 2 ? 'selected' : ''}" style="height: 24px; line-height: 24px; font-size: 16px; text-align: center; width: 100%; display: flex; justify-content: center; align-items: center;">
                                返回
                            </div>
                        </div>
                    `;
                    
                    // 更新屏幕动态区域内容
                    screenContent.innerHTML = content;
                },
                
                // 更新恢复出厂设置页面显示
                updateResetFactoryDisplay: function() {
                    let content = `
                        <div class="settings-content">
                            <!-- 第1行：空行 -->
                            <div style="height: 24px; width: 100%;"></div>
                            <!-- 第2行：是否恢复出厂设置？ -->
                            <div style="height: 24px; line-height: 24px; font-size: 16px; text-align: center; width: 100%; display: flex; justify-content: center; align-items: center;">
                                是否恢复出厂设置？
                            </div>
                            <!-- 第3-4行：图标 -->
                            <div style="height: 48px; width: 100%; display: flex; justify-content: center; align-items: center; text-align: center;">
                                <svg t="1764729596966" class="icon" viewBox="0 0 1104 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="7404" width="32" height="32"><path d="M961.369 1020.986H141.063c-55.01 0-99.202-21.701-121.272-59.552-22.076-37.85-19.39-87.293 7.396-135.606l413.89-746.48c26.941-48.666 67.004-76.561 109.866-76.561 42.867 0 82.89 27.86 109.907 76.483l414.323 746.635c26.78 48.314 29.55 97.72 7.433 135.565-22.035 37.85-66.263 59.516-121.237 59.516zM550.984 81.148c-13.628 0-29.239 13.595-41.894 36.362L95.202 864.067c-12.968 23.43-16.004 44.475-8.258 57.752 7.753 13.244 27.488 20.85 54.119 20.85h820.306c26.673 0 46.372-7.565 54.119-20.85 7.704-13.242 4.71-34.28-8.293-57.71l-414.318-746.6c-12.618-22.766-28.306-36.361-41.893-36.361z m0.233 586.348c-21.488 0-38.93-17.516-38.93-39.182v-352.63c0-21.63 17.442-39.183 38.93-39.183 21.492 0 38.934 17.554 38.934 39.183v352.63c0 21.666-17.442 39.182-38.934 39.182z m-0.279 191.523c33.503 0 60.663-27.382 60.663-61.16 0-33.777-27.16-61.159-60.663-61.159s-60.663 27.382-60.663 61.16c0 33.777 27.16 61.16 60.663 61.16z" p-id="7405"></path></svg>
                            </div>
                            <!-- 第5行：取消，默认选中 -->
                            <div class="settings-item ${this.resetFactoryIndex === 0 ? 'selected' : ''}" style="height: 24px; line-height: 24px; font-size: 16px; text-align: center; width: 100%; display: flex; justify-content: center; align-items: center;">
                                取消
                            </div>
                            <!-- 第6行：确定 -->
                            <div class="settings-item ${this.resetFactoryIndex === 1 ? 'selected' : ''}" style="height: 24px; line-height: 24px; font-size: 16px; text-align: center; width: 100%; display: flex; justify-content: center; align-items: center;">
                                确定
                            </div>
                        </div>
                    `;
                    
                    // 更新屏幕动态区域内容
                    screenContent.innerHTML = content;
                },
                
                // 更新发送指令页面显示
                updateCommandSendDisplay: function() {
                    const currentDevice = this.devices[this.currentDeviceIndex] || '';
                    const commandText = this.currentCommand;
                    
                    // 用户提供的SVG图标，已清理格式
                    const commandIcon = `<svg t="1764679476517" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="77614" width="32" height="32"><path d="M210.304 124.970667l60.330667 60.330666A340.266667 340.266667 0 0 0 170.666667 426.666667c0 94.293333 38.186667 179.626667 99.968 241.365333L210.346667 728.32A425.386667 425.386667 0 0 1 85.333333 426.666667a425.344 425.344 0 0 1 124.970667-301.696z m603.392 0A425.301333 425.301333 0 0 1 938.666667 426.666667a425.301333 425.301333 0 0 1-124.970667 301.696l-60.330667-60.330667A340.181333 340.181333 0 0 0 853.333333 426.666667c0-94.293333-38.186667-179.626667-99.968-241.365334L813.653333 125.013333l0.042667-0.042666zM330.965333 245.632l60.373334 60.373333A170.112 170.112 0 0 0 341.333333 426.666667c0 47.146667 19.114667 89.813333 50.005334 120.661333l-60.373334 60.373333A255.189333 255.189333 0 0 1 256 426.666667c0-70.698667 28.672-134.698667 74.965333-181.034667z m362.069334 0A255.232 255.232 0 0 1 768 426.666667a255.232 255.232 0 0 1-74.965333 181.034666l-60.373334-60.373333A170.112 170.112 0 0 0 682.666667 426.666667a170.069333 170.069333 0 0 0-50.005334-120.661334l60.373334-60.373333zM512 512a85.333333 85.333333 0 1 1 0-170.666667 85.333333 85.333333 0 0 1 0 170.666667z m-42.666667 85.333333h85.333334v341.333334h-85.333334v-341.333334z" p-id="77615"></path></svg>`;
                    
                    let content = `
                        <div class="settings-content">
                            <!-- 第1行：设备名称 -->
                            <div style="height: 24px; width: 100%; display: flex; justify-content: center; align-items: center;">
                                <span style="text-align: center; font-size: 16px;">${currentDevice}</span>
                            </div>
                            <!-- 第2行：空行 -->
                            <div style="height: 24px; width: 100%;"></div>
                            <!-- 第3-4行：显示指定icon -->
                            <div style="height: 48px; width: 100%; display: flex; justify-content: center; align-items: center;">
                                ${commandIcon}
                            </div>
                            <!-- 第5行：空行 -->
                            <div style="height: 24px; width: 100%;"></div>
                            <!-- 第6行：显示对应按钮的指令 -->
                            <div style="height: 24px; width: 100%; display: flex; justify-content: center; align-items: center;">
                                <span style="text-align: center; font-size: 16px;">${commandText}</span>
                            </div>
                        </div>
                    `;
                    
                    // 更新屏幕动态区域内容
                    screenContent.innerHTML = content;
                    
                    // 设置3秒后自动返回待机页面
                    if (this.commandTimer) {
                        clearTimeout(this.commandTimer);
                    }
                    this.commandTimer = setTimeout(() => {
                        this.currentPage = 'standby';
                        this.updateStandbyDisplay();
                        this.commandTimer = null;
                    }, 3000);
                }
        };

        // 初始化显示
        appState.updateStandbyDisplay();

        // 按钮点击事件处理
        function handleButtonClick(buttonId) {
            console.log(`点击了按钮: ${buttonId}`);
            
            // 检查童锁状态，如果童锁开启、设备数量大于0且点击了受限制的按钮，显示童锁提示
            if (appState.isChildLockEnabled && appState.devices.length > 0) {
                // 检查是否点击了受限制的按钮（开、停、关、A）
                if (['open', 'stop', 'close', 'a'].includes(buttonId)) {
                    // 显示童锁提示页面
                    appState.currentPage = 'childLockTip';
                    appState.updateChildLockTipDisplay();
                    return;
                }
            }
            
            // 童锁提示页面按任意键返回
            if (appState.currentPage === 'childLockTip') {
                // 清除3秒定时器
                if (appState.childLockTipTimer) {
                    clearTimeout(appState.childLockTipTimer);
                    appState.childLockTipTimer = null;
                }
                // 返回待机页面
                appState.currentPage = 'standby';
                appState.updateStandbyDisplay();
                return;
            }
            
            // 童锁状态切换提示页面（开启或关闭）按任意键返回待机
            if (appState.currentPage === 'childLockClosed' || appState.currentPage === 'childLockOpened') {
                // 清除倒计时计时器
                if (appState.childLockCountdownTimer) {
                    clearInterval(appState.childLockCountdownTimer);
                    appState.childLockCountdownTimer = null;
                }
                if (appState.childLockCountdownInterval) {
                    clearInterval(appState.childLockCountdownInterval);
                    appState.childLockCountdownInterval = null;
                }
                // 返回待机页面
                appState.currentPage = 'standby';
                appState.updateStandbyDisplay();
                return;
            }
            
            // 根据当前页面和按钮点击更新动态内容
            switch (appState.currentPage) {
                case 'standby':
                    // 待机页面逻辑
                    switch (buttonId) {
                        case 'up':
                            appState.nextDevice();
                            break;
                        case 'down':
                            appState.prevDevice();
                            break;
                        case 'ok':
                            appState.goToSettings();
                            break;
                        case 'home':
                            console.log('已在主页');
                            break;
                        case 'open':
                        case 'stop':
                        case 'close':
                        case 'a':
                            // 只有当有设备数据时才允许触发发送指令事件
                            if (appState.devices.length > 0) {
                                // 根据按钮类型设置对应的指令
                                const commandMap = {
                                    'open': '开',
                                    'stop': '停',
                                    'close': '关',
                                    'a': 'A'
                                };
                                appState.currentCommand = commandMap[buttonId];
                                appState.currentPage = 'commandSend';
                                appState.updateCommandSendDisplay();
                            }
                            break;
                    }
                    break;
                    
                case 'settings':
                    // 设置页面逻辑
                    switch (buttonId) {
                        case 'up':
                            appState.prevSetting();
                            break;
                        case 'down':
                            appState.nextSetting();
                            break;
                        case 'ok':
                            appState.selectSetting();
                            break;
                        case 'home':
                            appState.goToStandby();
                            break;
                        case 'open':
                            console.log('打开');
                            break;
                        case 'stop':
                            console.log('停止');
                            break;
                        case 'close':
                            console.log('关闭');
                            break;
                        case 'a':
                            console.log('切换内容');
                            break;
                    }
                    break;
                    
                case 'submenu':
                    // 子菜单页面逻辑
                    switch (buttonId) {
                        case 'up':
                            appState.prevSubMenuItem();
                            break;
                        case 'down':
                            appState.nextSubMenuItem();
                            break;
                        case 'ok':
                            appState.selectSubMenuItem();
                            break;
                        case 'home':
                            appState.goToStandby();
                            break;
                        case 'open':
                            console.log('打开');
                            break;
                        case 'stop':
                            console.log('停止');
                            break;
                        case 'close':
                            console.log('关闭');
                            break;
                        case 'a':
                            console.log('切换内容');
                            break;
                    }
                    break;
                    
                case 'bluetoothPairing':
                    // 蓝牙配对页面逻辑
                    switch (buttonId) {
                        case 'ok':
                            // 仅保留倒计时至57秒自动跳转，点击OK不再执行跳转
                            break;
                        case 'home':
                            // 进入退出配对确认页面，倒计时继续运行
                            appState.currentPage = 'exitPairingConfirm';
                            appState.exitPairingIndex = 0; // 默认选中"取消"
                            appState.updateExitPairingConfirmDisplay();
                            break;
                        case 'open':
                        case 'stop':
                        case 'close':
                        case 'up':
                        case 'down':
                        case 'a':
                            // 蓝牙配对页面忽略其他按钮
                            break;
                    }
                    break;
                    
                case 'bluetoothConnectPhone':
                    // 蓝牙连接手机页面逻辑
                    switch (buttonId) {
                        case 'home':
                            // 进入退出配对确认页面，倒计时继续运行
                            appState.currentPage = 'exitPairingConfirm';
                            appState.exitPairingIndex = 0; // 默认选中"取消"
                            appState.updateExitPairingConfirmDisplay();
                            break;
                        case 'ok':
                        case 'open':
                        case 'stop':
                        case 'close':
                        case 'up':
                        case 'down':
                        case 'a':
                            // 蓝牙连接手机页面忽略其他按钮
                            break;
                    }
                    break;
                    
                case 'phoneCommunicating':
                    // 与手机通信中页面逻辑
                    switch (buttonId) {
                        case 'home':
                            // 返回待机页面
                            if (appState.countdownInterval) {
                                clearInterval(appState.countdownInterval);
                                appState.countdownInterval = null;
                            }
                            if (appState.broadcastInterval) {
                                clearInterval(appState.broadcastInterval);
                                appState.broadcastInterval = null;
                            }
                            appState.currentPage = 'standby';
                            appState.updateStandbyDisplay();
                            break;
                        case 'ok':
                        case 'open':
                        case 'stop':
                        case 'close':
                        case 'up':
                        case 'down':
                        case 'a':
                            // 与手机通信中页面忽略其他按钮
                            break;
                    }
                    break;
                    
                case 'exitPairingConfirm':
                    // 退出配对确认页面逻辑
                    switch (buttonId) {
                        case 'up':
                            appState.prevExitPairingOption();
                            break;
                        case 'down':
                            appState.nextExitPairingOption();
                            break;
                        case 'ok':
                            appState.selectExitPairingOption();
                            break;
                        case 'home':
                            // 忽略home键，防止无限循环
                            break;
                        case 'open':
                        case 'stop':
                        case 'close':
                        case 'a':
                            // 退出配对确认页面忽略其他按钮
                            break;
                    }
                    break;
                    
                case 'pairingResult':
                    // 配对结果确认页面逻辑
                    switch (buttonId) {
                        case 'ok':
                            // 清除3秒倒计时定时器
                            if (appState.pairingSuccessTimer) {
                                clearTimeout(appState.pairingSuccessTimer);
                                appState.pairingSuccessTimer = null;
                            }
                            // 重置标志
                            appState.isAddingSameControlDevice = false;
                            appState.isRePairing = false;
                            appState.rePairingDeviceIndex = -1;
                            appState.isFromDeviceInfo = false;
                            // 返回门窗信息页面
                            appState.currentPage = 'doorWindowInfo';
                            appState.updateDoorWindowInfoDisplay();
                            break;
                        case 'home':
                            // 清除3秒倒计时定时器
                            if (appState.pairingSuccessTimer) {
                                clearTimeout(appState.pairingSuccessTimer);
                                appState.pairingSuccessTimer = null;
                            }
                            // 重置标志
                            appState.isAddingSameControlDevice = false;
                            appState.isRePairing = false;
                            appState.rePairingDeviceIndex = -1;
                            appState.isFromDeviceInfo = false;
                            // 返回待机页面
                            appState.goToStandby();
                            break;
                        case 'open':
                        case 'stop':
                        case 'close':
                        case 'up':
                        case 'down':
                        case 'a':
                            // 配对结果确认页面忽略其他按钮
                            break;
                    }
                    break;
                    
                case 'continuePairing':
                    // 添加更多设备页面逻辑
                    switch (buttonId) {
                        case 'up':
                            appState.prevContinuePairingOption();
                            break;
                        case 'down':
                            appState.nextContinuePairingOption();
                            break;
                        case 'ok':
                            appState.selectContinuePairingOption();
                            break;
                        case 'home':
                            appState.goToStandby();
                            break;
                        case 'open':
                        case 'stop':
                        case 'close':
                        case 'a':
                            // 添加更多设备页面忽略其他按钮
                            break;
                    }
                    break;
                    
                case 'pairingTimeout':
                    // 配对超时页面逻辑
                    switch (buttonId) {
                        case 'up':
                            appState.prevContinuePairingOption();
                            break;
                        case 'down':
                            appState.nextContinuePairingOption();
                            break;
                        case 'ok':
                            appState.selectContinuePairingOption();
                            break;
                        case 'home':
                            appState.goToStandby();
                            break;
                        case 'open':
                        case 'stop':
                        case 'close':
                        case 'a':
                            // 配对超时页面忽略其他按钮
                            break;
                    }
                    break;
                    
                case 'doorWindowInfo':
                    // 门窗信息页面逻辑
                    switch (buttonId) {
                        case 'up':
                            appState.prevDoorWindowInfoItem();
                            break;
                        case 'down':
                            appState.nextDoorWindowInfoItem();
                            break;
                        case 'ok':
                            appState.selectDoorWindowInfoItem();
                            break;
                        case 'home':
                            // 返回待机页面
                            appState.goToStandby();
                            break;
                        case 'open':
                        case 'stop':
                        case 'close':
                        case 'a':
                            // 门窗信息页面忽略其他按钮
                            break;
                    }
                    break;
                    
                case 'autoCloseEnabled':
                case 'autoCloseDisabled':
                case 'autoCloseManual':
                    // 自动关门感应相关页面逻辑
                    switch (buttonId) {
                        case 'home':
                            // 返回待机页面
                            // 清除可能存在的定时器
                            if (appState.autoCloseTimer) {
                                clearTimeout(appState.autoCloseTimer);
                                appState.autoCloseTimer = null;
                            }
                            appState.goToStandby();
                            break;
                        case 'ok':
                        case 'open':
                        case 'stop':
                        case 'close':
                        case 'up':
                        case 'down':
                        case 'a':
                            // 自动关门感应相关页面忽略其他按钮
                            break;
                    }
                    break;
                    
                case 'displayMode':
                    // 显示模式页面逻辑
                    switch (buttonId) {
                        case 'up':
                            // 选择上一个选项
                            appState.displayModeIndex = appState.displayModeIndex === 0 ? 2 : appState.displayModeIndex - 1;
                            appState.updateDisplayModeDisplay();
                            break;
                        case 'down':
                            // 选择下一个选项
                            appState.displayModeIndex = appState.displayModeIndex === 2 ? 0 : appState.displayModeIndex + 1;
                            appState.updateDisplayModeDisplay();
                            break;
                        case 'ok':
                            // 确认选择，返回上一页
                            appState.currentPage = 'submenu';
                            appState.currentSubMenu = '更多';
                            appState.subMenuIndex = 0;
                            appState.subMenuPage = 0;
                            appState.updateSubMenuDisplay();
                            break;
                        case 'home':
                            // 返回待机页面
                            appState.goToStandby();
                            break;
                        case 'open':
                        case 'stop':
                        case 'close':
                        case 'a':
                            // 显示模式页面忽略其他按钮
                            break;
                    }
                    break;
                case 'language':
                    // 语言设置页面逻辑
                    switch (buttonId) {
                        case 'up':
                            // 选择上一个选项
                            appState.languageIndex = appState.languageIndex === 0 ? 2 : appState.languageIndex - 1;
                            appState.updateLanguageDisplay();
                            break;
                        case 'down':
                            // 选择下一个选项
                            appState.languageIndex = appState.languageIndex === 2 ? 0 : appState.languageIndex + 1;
                            appState.updateLanguageDisplay();
                            break;
                        case 'ok':
                            // 确认选择，返回上一页
                            appState.currentPage = 'submenu';
                            appState.currentSubMenu = '更多';
                            appState.subMenuIndex = 0;
                            appState.subMenuPage = 0;
                            appState.updateSubMenuDisplay();
                            break;
                        case 'home':
                            // 返回待机页面
                            appState.goToStandby();
                            break;
                        case 'open':
                        case 'stop':
                        case 'close':
                        case 'a':
                            // 语言设置页面忽略其他按钮
                            break;
                    }
                    break;
                case 'resetFactory':
                    // 恢复出厂设置页面逻辑
                    switch (buttonId) {
                        case 'up':
                        case 'down':
                            // 切换选项
                            appState.resetFactoryIndex = appState.resetFactoryIndex === 0 ? 1 : 0;
                            appState.updateResetFactoryDisplay();
                            break;
                        case 'ok':
                            // 确认选择
                            if (appState.resetFactoryIndex === 0) {
                                // 选择"取消"，返回上一页
                                appState.currentPage = 'submenu';
                                appState.currentSubMenu = '更多';
                                appState.subMenuIndex = 0;
                                appState.subMenuPage = 0;
                                appState.updateSubMenuDisplay();
                            } else {
                                // 选择"确定"，执行恢复出厂设置，返回待机页面
                                // 清除所有设备数据
                                appState.devices = [];
                                appState.currentDeviceIndex = 0;
                                // 返回待机页面
                                appState.goToStandby();
                            }
                            break;
                        case 'home':
                            // 返回待机页面
                            appState.goToStandby();
                            break;
                        case 'open':
                        case 'stop':
                        case 'close':
                        case 'a':
                            // 恢复出厂设置页面忽略其他按钮
                            break;
                    }
                    break;
                case 'commandSend':
                    // 发送指令页面逻辑 - 按任意键立即返回待机页面
                    if (appState.commandTimer) {
                        clearTimeout(appState.commandTimer);
                        appState.commandTimer = null;
                    }
                    appState.currentPage = 'standby';
                    appState.updateStandbyDisplay();
                    break;
                case 'deleteConfirm':
                    // 删除确认页面逻辑
                    switch (buttonId) {
                        case 'up':
                            appState.prevDeleteConfirmOption();
                            break;
                        case 'down':
                            appState.nextDeleteConfirmOption();
                            break;
                        case 'ok':
                            appState.selectDeleteConfirmOption();
                            break;
                        case 'home':
                            // 返回待机页面
                            appState.goToStandby();
                            break;
                        case 'open':
                        case 'stop':
                        case 'close':
                        case 'a':
                            // 删除确认页面忽略其他按钮
                            break;
                    }
                    break;
            }
        }

        // 绑定按钮事件
        buttons.open.addEventListener('click', () => handleButtonClick('open'));
        buttons.up.addEventListener('click', () => handleButtonClick('up'));
        buttons.stop.addEventListener('click', () => handleButtonClick('stop'));
        buttons.down.addEventListener('click', () => handleButtonClick('down'));
        buttons.close.addEventListener('click', () => handleButtonClick('close'));
        buttons.ok.addEventListener('click', () => handleButtonClick('ok'));
        buttons.a.addEventListener('click', () => handleButtonClick('a'));
        buttons.home.addEventListener('click', () => handleButtonClick('home'));
    </script>
</body>
</html>